<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIåˆ†ææŠ¥å‘Š - èŒèŠ½AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="mengya-common.js"></script>
    <script src="learning-analytics.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .report-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 30px rgba(139, 92, 246, 0.1);
            overflow: hidden;
            margin: 16px;
        }
        .report-header {
            background: linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%);
            color: white;
            padding: 24px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .report-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: aiGlow 4s ease-in-out infinite;
        }
        @keyframes aiGlow {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
        }
        .ai-icon {
            font-size: 48px;
            margin-bottom: 12px;
            animation: aiPulse 3s ease-in-out infinite;
        }
        @keyframes aiPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 16px;
            padding: 20px;
            background: #f8fafc;
        }
        .stat-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--color);
        }
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        .stat-number {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
        }
        .stat-label {
            font-size: 14px;
            color: #6b7280;
            font-weight: 500;
        }
        .analysis-section {
            padding: 24px;
        }
        .section-title {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 16px;
        }
        .section-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }
        .insight-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid #0ea5e9;
            border-radius: 16px;
            padding: 20px;
            margin: 16px 0;
            position: relative;
        }
        .insight-card::before {
            content: 'ğŸ¤–';
            position: absolute;
            top: 16px;
            right: 16px;
            font-size: 24px;
        }
        .ability-analysis {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 16px;
            padding: 20px;
            margin: 16px 0;
            transition: all 0.3s ease;
        }
        .ability-analysis:hover {
            border-color: #3B82F6;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.1);
        }
        .ability-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }
        .ability-icon {
            width: 48px;
            height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: white;
            margin-right: 16px;
        }
        .ability-info {
            flex: 1;
        }
        .ability-name {
            font-size: 18px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 4px;
        }
        .ability-description {
            font-size: 14px;
            color: #6b7280;
        }
        .progress-container {
            margin: 16px 0;
        }
        .progress-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .progress-level {
            font-size: 12px;
            font-weight: 500;
            padding: 2px 8px;
            border-radius: 12px;
            color: white;
        }
        .progress-bar {
            background: #f3f4f6;
            border-radius: 10px;
            height: 8px;
            position: relative;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            border-radius: 10px;
            position: relative;
            transition: width 2s ease;
        }
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .trend-card {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #f59e0b;
            border-radius: 16px;
            padding: 20px;
            margin: 16px 0;
            position: relative;
        }
        .trend-card::before {
            content: 'ğŸ“ˆ';
            position: absolute;
            top: 16px;
            right: 16px;
            font-size: 24px;
        }
        .suggestions-card {
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border: 2px solid #22c55e;
            border-radius: 16px;
            padding: 20px;
            margin: 16px 0;
            position: relative;
        }
        .suggestions-card::before {
            content: 'ğŸ’¡';
            position: absolute;
            top: 16px;
            right: 16px;
            font-size: 24px;
        }
        .suggestion-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 16px;
            padding: 12px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 12px;
        }
        .suggestion-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }
        .chart-container {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin: 16px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .chart-bar {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }
        .chart-label {
            width: 80px;
            font-size: 14px;
            color: #374151;
            font-weight: 500;
        }
        .chart-progress {
            flex: 1;
            height: 24px;
            background: #f3f4f6;
            border-radius: 12px;
            overflow: hidden;
            margin: 0 12px;
            position: relative;
        }
        .chart-fill {
            height: 100%;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
            color: white;
            font-size: 12px;
            font-weight: 600;
            transition: width 2s ease;
        }
        .achievement-timeline {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin: 16px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        .timeline-item {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 16px 0;
            border-bottom: 1px solid #e5e7eb;
        }
        .timeline-item:last-child {
            border-bottom: none;
        }
        .timeline-date {
            width: 60px;
            font-size: 12px;
            color: #6b7280;
            text-align: center;
        }
        .timeline-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: white;
            flex-shrink: 0;
        }
        .timeline-content {
            flex: 1;
        }
        .timeline-title {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 4px;
        }
        .timeline-description {
            font-size: 12px;
            color: #6b7280;
        }
        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin: 24px 0;
        }
        .action-btn {
            padding: 16px;
            border-radius: 16px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }
        .primary-btn {
            background: linear-gradient(45deg, #3B82F6, #1D4ED8);
            color: white;
        }
        .primary-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }
        .secondary-btn {
            background: white;
            border: 2px solid #e5e7eb;
            color: #374151;
        }
        .secondary-btn:hover {
            background: #f9fafb;
            border-color: #3B82F6;
            transform: translateY(-1px);
        }
        .floating-export {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #22c55e, #16a34a);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.4);
            animation: exportFloat 3s ease-in-out infinite;
            z-index: 1000;
        }
        @keyframes exportFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <div class="gradient-bg px-6 py-6 text-white">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <button class="w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center hover:bg-opacity-30 transition-all" onclick="navigateBack()">
                    <i class="fas fa-arrow-left text-sm"></i>
                </button>
                <h1 class="text-xl font-bold">AIåˆ†ææŠ¥å‘Š</h1>
            </div>
            <div class="text-sm opacity-90">
                <i class="fas fa-calendar mr-1"></i>
                <span id="reportDate">æœ¬å‘¨</span>
            </div>
        </div>
    </div>

    <!-- ä¸»è¦å†…å®¹ -->
    <div class="pb-32">
        <div class="report-container">
            <!-- æŠ¥å‘Šå¤´éƒ¨ -->
            <div class="report-header">
                <div class="ai-icon">ğŸ§ </div>
                <h2 class="text-2xl font-bold mb-2">æ™ºèƒ½æˆé•¿åˆ†æ</h2>
                <p class="text-blue-100">åŸºäºAIæ·±åº¦å­¦ä¹ çš„ä¸ªæ€§åŒ–èƒ½åŠ›è¯„ä¼°æŠ¥å‘Š</p>
            </div>

            <!-- æ ¸å¿ƒæ•°æ®ç»Ÿè®¡ -->
            <div class="stats-grid">
                <div class="stat-card" style="--color: linear-gradient(90deg, #3B82F6, #1D4ED8);">
                    <div class="stat-number text-blue-600">92</div>
                    <div class="stat-label">ç»¼åˆèƒ½åŠ›åˆ†</div>
                </div>
                <div class="stat-card" style="--color: linear-gradient(90deg, #10B981, #059669);">
                    <div class="stat-number text-green-600">15</div>
                    <div class="stat-label">æœ¬å‘¨å®Œæˆä»»åŠ¡</div>
                </div>
                <div class="stat-card" style="--color: linear-gradient(90deg, #F59E0B, #D97706);">
                    <div class="stat-number text-amber-600">12h</div>
                    <div class="stat-label">ç´¯è®¡å­¦ä¹ æ—¶é•¿</div>
                </div>
                <div class="stat-card" style="--color: linear-gradient(90deg, #EC4899, #BE185D);">
                    <div class="stat-number text-pink-600">+8</div>
                    <div class="stat-label">èƒ½åŠ›æå‡ç‚¹</div>
                </div>
            </div>

            <!-- åˆ†æå†…å®¹ -->
            <div class="analysis-section">
                <!-- AIæ·±åº¦æ´å¯Ÿ -->
                <div class="section-title">
                    <div class="section-icon"><i class="fas fa-brain"></i></div>
                    <span>AIæ·±åº¦æ´å¯Ÿ</span>
                </div>

                <!-- åŠ¨æ€AIæ´å¯Ÿå¡ç‰‡ -->
                <div id="insightContainer">
                    <!-- æ´å¯Ÿå†…å®¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                    <div class="insight-card">
                        <h4 class="font-semibold text-sky-800 mb-3">ğŸ§  AIæ­£åœ¨æ·±åº¦åˆ†æä¸­...</h4>
                        <div class="flex items-center justify-center py-8">
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-sky-600"></div>
                            <span class="ml-3 text-sky-600">æ­£åœ¨è¿è¡Œæ·±åº¦å­¦ä¹ åˆ†æå¼•æ“...</span>
                        </div>
                    </div>
                </div>

                <!-- å­¦ä¹ è¡Œä¸ºæ¨¡å¼åˆ†æ -->
                <div class="section-title mt-8">
                    <div class="section-icon"><i class="fas fa-brain"></i></div>
                    <span>å­¦ä¹ è¡Œä¸ºæ·±åº¦åˆ†æ</span>
                </div>

                <div class="behavior-analysis-grid grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- å­¦ä¹ æ—¶é—´åå¥½ -->
                    <div class="behavior-card bg-white rounded-xl p-4 shadow-md" id="timePreferences">
                        <div class="behavior-header flex items-center mb-3">
                            <div class="behavior-icon w-10 h-10 rounded-lg flex items-center justify-center mr-3" style="background: linear-gradient(135deg, #F59E0B, #D97706);">
                                <i class="fas fa-clock text-white"></i>
                            </div>
                            <div class="behavior-info">
                                <div class="behavior-title font-semibold text-gray-800">å­¦ä¹ æ—¶é—´åå¥½</div>
                                <div class="behavior-status text-sm text-gray-500" id="timePreferenceStatus">AIåˆ†æä¸­...</div>
                            </div>
                        </div>
                        <div class="behavior-details" id="timePreferenceDetails">
                            <div class="animate-pulse bg-gray-200 h-4 rounded mb-2"></div>
                            <div class="animate-pulse bg-gray-200 h-3 rounded"></div>
                        </div>
                    </div>

                    <!-- æ³¨æ„åŠ›æ¨¡å¼ -->
                    <div class="behavior-card bg-white rounded-xl p-4 shadow-md" id="attentionPatterns">
                        <div class="behavior-header flex items-center mb-3">
                            <div class="behavior-icon w-10 h-10 rounded-lg flex items-center justify-center mr-3" style="background: linear-gradient(135deg, #10B981, #059669);">
                                <i class="fas fa-eye text-white"></i>
                            </div>
                            <div class="behavior-info">
                                <div class="behavior-title font-semibold text-gray-800">ä¸“æ³¨åŠ›æ¨¡å¼</div>
                                <div class="behavior-status text-sm text-gray-500" id="attentionStatus">AIåˆ†æä¸­...</div>
                            </div>
                        </div>
                        <div class="behavior-details" id="attentionDetails">
                            <div class="animate-pulse bg-gray-200 h-4 rounded mb-2"></div>
                            <div class="animate-pulse bg-gray-200 h-3 rounded"></div>
                        </div>
                    </div>

                    <!-- å­¦ä¹ ç­–ç•¥åå¥½ -->
                    <div class="behavior-card bg-white rounded-xl p-4 shadow-md" id="learningStrategies">
                        <div class="behavior-header flex items-center mb-3">
                            <div class="behavior-icon w-10 h-10 rounded-lg flex items-center justify-center mr-3" style="background: linear-gradient(135deg, #8B5CF6, #7C3AED);">
                                <i class="fas fa-lightbulb text-white"></i>
                            </div>
                            <div class="behavior-info">
                                <div class="behavior-title font-semibold text-gray-800">å­¦ä¹ ç­–ç•¥åå¥½</div>
                                <div class="behavior-status text-sm text-gray-500" id="strategyStatus">AIåˆ†æä¸­...</div>
                            </div>
                        </div>
                        <div class="behavior-details" id="strategyDetails">
                            <div class="animate-pulse bg-gray-200 h-4 rounded mb-2"></div>
                            <div class="animate-pulse bg-gray-200 h-3 rounded"></div>
                        </div>
                    </div>

                    <!-- æƒ…æ„ŸçŠ¶æ€åˆ†æ -->
                    <div class="behavior-card bg-white rounded-xl p-4 shadow-md" id="emotionalState">
                        <div class="behavior-header flex items-center mb-3">
                            <div class="behavior-icon w-10 h-10 rounded-lg flex items-center justify-center mr-3" style="background: linear-gradient(135deg, #EC4899, #BE185D);">
                                <i class="fas fa-heart text-white"></i>
                            </div>
                            <div class="behavior-info">
                                <div class="behavior-title font-semibold text-gray-800">æƒ…æ„ŸçŠ¶æ€åˆ†æ</div>
                                <div class="behavior-status text-sm text-gray-500" id="emotionalStatus">AIåˆ†æä¸­...</div>
                            </div>
                        </div>
                        <div class="behavior-details" id="emotionalDetails">
                            <div class="animate-pulse bg-gray-200 h-4 rounded mb-2"></div>
                            <div class="animate-pulse bg-gray-200 h-3 rounded"></div>
                        </div>
                    </div>
                </div>

                <!-- èƒ½åŠ›ç»´åº¦åˆ†æ -->
                <div class="section-title">
                    <div class="section-icon"><i class="fas fa-chart-radar"></i></div>
                    <span>èƒ½åŠ›ç»´åº¦åˆ†æ</span>
                </div>

                <div class="ability-analysis">
                    <div class="ability-header">
                        <div class="flex items-center">
                            <div class="ability-icon" style="background: linear-gradient(135deg, #8B5CF6, #7C3AED);">ğŸ¨</div>
                            <div class="ability-info">
                                <div class="ability-name">åˆ›æ„è¡¨è¾¾èƒ½åŠ›</div>
                                <div class="ability-description">æƒ³è±¡åŠ›å’Œè¯­è¨€è¡¨è¾¾çš„ç»¼åˆä½“ç°</div>
                            </div>
                        </div>
                        <div class="progress-level" style="background: linear-gradient(135deg, #8B5CF6, #7C3AED);">ä¼˜ç§€</div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-label">
                            <span class="text-sm font-medium">å½“å‰æ°´å¹³</span>
                            <span class="text-sm text-purple-600 font-bold">88/100</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 88%; background: linear-gradient(90deg, #8B5CF6, #7C3AED);"></div>
                        </div>
                    </div>
                    
                    <div class="text-sm text-gray-600 mt-3">
                        <strong>AIè¯„ä»·ï¼š</strong>åœ¨æ•…äº‹åˆ›ä½œä¸­å±•ç°å‡ºä¸°å¯Œçš„æƒ³è±¡åŠ›ï¼Œèƒ½å¤Ÿæ„å»ºå®Œæ•´çš„æ•…äº‹æƒ…èŠ‚ï¼Œè¯æ±‡è¿ç”¨æ°å½“ï¼Œè¡¨è¾¾ç”ŸåŠ¨æœ‰è¶£ã€‚
                    </div>
                </div>

                <div class="ability-analysis">
                    <div class="ability-header">
                        <div class="flex items-center">
                            <div class="ability-icon" style="background: linear-gradient(135deg, #10B981, #059669);">ğŸ§®</div>
                            <div class="ability-info">
                                <div class="ability-name">é€»è¾‘æ€ç»´èƒ½åŠ›</div>
                                <div class="ability-description">åˆ†ææ¨ç†å’Œé—®é¢˜è§£å†³èƒ½åŠ›</div>
                            </div>
                        </div>
                        <div class="progress-level" style="background: linear-gradient(135deg, #10B981, #059669);">è‰¯å¥½</div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-label">
                            <span class="text-sm font-medium">å½“å‰æ°´å¹³</span>
                            <span class="text-sm text-green-600 font-bold">72/100</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 72%; background: linear-gradient(90deg, #10B981, #059669);"></div>
                        </div>
                    </div>
                    
                    <div class="text-sm text-gray-600 mt-3">
                        <strong>AIè¯„ä»·ï¼š</strong>èƒ½å¤Ÿç†è§£åŸºæœ¬çš„é€»è¾‘å…³ç³»ï¼Œåœ¨è§£å†³é—®é¢˜æ—¶æœ‰è‡ªå·±çš„æ€è·¯ï¼Œä½†åœ¨å¤æ‚æ¨ç†æ–¹é¢è¿˜æœ‰æå‡ç©ºé—´ã€‚
                    </div>
                </div>

                <div class="ability-analysis">
                    <div class="ability-header">
                        <div class="flex items-center">
                            <div class="ability-icon" style="background: linear-gradient(135deg, #F59E0B, #D97706);">ğŸ’¬</div>
                            <div class="ability-info">
                                <div class="ability-name">æ²Ÿé€šäº¤æµèƒ½åŠ›</div>
                                <div class="ability-description">ä¸ä»–äººäº’åŠ¨å’Œè¡¨è¾¾çš„èƒ½åŠ›</div>
                            </div>
                        </div>
                        <div class="progress-level" style="background: linear-gradient(135deg, #F59E0B, #D97706);">ä¼˜ç§€</div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-label">
                            <span class="text-sm font-medium">å½“å‰æ°´å¹³</span>
                            <span class="text-sm text-amber-600 font-bold">85/100</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 85%; background: linear-gradient(90deg, #F59E0B, #D97706);"></div>
                        </div>
                    </div>
                    
                    <div class="text-sm text-gray-600 mt-3">
                        <strong>AIè¯„ä»·ï¼š</strong>å–„äºä¸AIåŠ©æ‰‹äº¤æµï¼Œèƒ½å¤Ÿæ¸…æ™°è¡¨è¾¾è‡ªå·±çš„æƒ³æ³•ï¼Œäº’åŠ¨ç§¯æä¸»åŠ¨ï¼Œç†è§£èƒ½åŠ›å¼ºã€‚
                    </div>
                </div>

                <div class="ability-analysis">
                    <div class="ability-header">
                        <div class="flex items-center">
                            <div class="ability-icon" style="background: linear-gradient(135deg, #EC4899, #BE185D);">ğŸ¯</div>
                            <div class="ability-info">
                                <div class="ability-name">ä¸“æ³¨æŒç»­åŠ›</div>
                                <div class="ability-description">é›†ä¸­æ³¨æ„åŠ›å®Œæˆä»»åŠ¡çš„èƒ½åŠ›</div>
                            </div>
                        </div>
                        <div class="progress-level" style="background: linear-gradient(135deg, #EC4899, #BE185D);">å¾…æå‡</div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-label">
                            <span class="text-sm font-medium">å½“å‰æ°´å¹³</span>
                            <span class="text-sm text-pink-600 font-bold">65/100</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 65%; background: linear-gradient(90deg, #EC4899, #BE185D);"></div>
                        </div>
                    </div>
                    
                    <div class="text-sm text-gray-600 mt-3">
                        <strong>AIè¯„ä»·ï¼š</strong>åœ¨æ„Ÿå…´è¶£çš„ä»»åŠ¡ä¸Šèƒ½å¤Ÿä¿æŒä¸“æ³¨ï¼Œä½†é‡åˆ°è¾ƒéš¾æˆ–æ¯ç‡¥çš„å†…å®¹æ—¶å®¹æ˜“åˆ†å¿ƒï¼Œéœ€è¦åŠ å¼ºä¸“æ³¨åŠ›è®­ç»ƒã€‚
                    </div>
                </div>

                <!-- å­¦ä¹ è¶‹åŠ¿åˆ†æ -->
                <div class="section-title">
                    <div class="section-icon"><i class="fas fa-chart-line"></i></div>
                    <span>å­¦ä¹ è¶‹åŠ¿åˆ†æ</span>
                </div>

                <div class="trend-card">
                    <h4 class="font-semibold text-amber-800 mb-3">ğŸ“Š æœ¬å‘¨è¡¨ç°è¶‹åŠ¿</h4>
                    <div class="chart-container">
                        <div class="chart-bar">
                            <div class="chart-label">å‘¨ä¸€</div>
                            <div class="chart-progress">
                                <div class="chart-fill" style="width: 75%; background: linear-gradient(90deg, #3B82F6, #1D4ED8);">75</div>
                            </div>
                        </div>
                        <div class="chart-bar">
                            <div class="chart-label">å‘¨äºŒ</div>
                            <div class="chart-progress">
                                <div class="chart-fill" style="width: 82%; background: linear-gradient(90deg, #10B981, #059669);">82</div>
                            </div>
                        </div>
                        <div class="chart-bar">
                            <div class="chart-label">å‘¨ä¸‰</div>
                            <div class="chart-progress">
                                <div class="chart-fill" style="width: 90%; background: linear-gradient(90deg, #8B5CF6, #7C3AED);">90</div>
                            </div>
                        </div>
                        <div class="chart-bar">
                            <div class="chart-label">å‘¨å››</div>
                            <div class="chart-progress">
                                <div class="chart-fill" style="width: 88%; background: linear-gradient(90deg, #F59E0B, #D97706);">88</div>
                            </div>
                        </div>
                        <div class="chart-bar">
                            <div class="chart-label">å‘¨äº”</div>
                            <div class="chart-progress">
                                <div class="chart-fill" style="width: 95%; background: linear-gradient(90deg, #EC4899, #BE185D);">95</div>
                            </div>
                        </div>
                    </div>
                    <p class="text-sm text-amber-700 mt-3">
                        æ•´ä½“å‘ˆç°<strong>ç¨³æ­¥ä¸Šå‡</strong>çš„è¶‹åŠ¿ï¼Œå‘¨äº”è¡¨ç°æœ€ä½³ã€‚å»ºè®®ä¿æŒç›®å‰çš„å­¦ä¹ èŠ‚å¥ï¼Œç»§ç»­å·©å›ºä¼˜åŠ¿ã€‚
                    </p>
                </div>

                <!-- ä¸ªæ€§åŒ–å»ºè®® -->
                <div class="section-title">
                    <div class="section-icon"><i class="fas fa-lightbulb"></i></div>
                    <span>ä¸ªæ€§åŒ–æˆé•¿å»ºè®®</span>
                </div>

                <div class="suggestions-card">
                    <h4 class="font-semibold text-green-800 mb-4">ğŸŒŸ AIä¸“å±å»ºè®®</h4>
                    
                    <div class="suggestion-item">
                        <div class="suggestion-icon">
                            <i class="fas fa-book-open"></i>
                        </div>
                        <div>
                            <div class="font-medium text-green-800 mb-1">æ·±åŒ–åˆ›æ„è¡¨è¾¾è®­ç»ƒ</div>
                            <div class="text-sm text-green-700">åŸºäºå°æ˜åœ¨åˆ›æ„æ–¹é¢çš„å¤©èµ‹ï¼Œå»ºè®®å¢åŠ æ•…äº‹ç»­å†™ã€è¯—æ­Œåˆ›ä½œç­‰é«˜é˜¶ä»»åŠ¡ï¼Œè¿›ä¸€æ­¥å‘æŒ¥æƒ³è±¡åŠ›ä¼˜åŠ¿ã€‚</div>
                        </div>
                    </div>

                    <div class="suggestion-item">
                        <div class="suggestion-icon">
                            <i class="fas fa-puzzle-piece"></i>
                        </div>
                        <div>
                            <div class="font-medium text-green-800 mb-1">é€»è¾‘æ€ç»´æ¸¸æˆåŒ–è®­ç»ƒ</div>
                            <div class="text-sm text-green-700">é€šè¿‡è¶£å‘³æ•°å­¦æ¸¸æˆã€æ¨ç†è°œé¢˜ç­‰æ–¹å¼ï¼Œåœ¨ä¿æŒå…´è¶£çš„åŒæ—¶æå‡é€»è¾‘æ€ç»´èƒ½åŠ›ã€‚</div>
                        </div>
                    </div>

                    <div class="suggestion-item">
                        <div class="suggestion-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div>
                            <div class="font-medium text-green-800 mb-1">ä¸“æ³¨åŠ›åˆ†é˜¶æ®µè®­ç»ƒ</div>
                            <div class="text-sm text-green-700">ä»15åˆ†é’Ÿå¼€å§‹ï¼Œé€æ­¥å»¶é•¿ä¸“æ³¨æ—¶é—´ã€‚å¯ä½¿ç”¨ç•ªèŒ„å·¥ä½œæ³•ï¼Œä¸­é—´ç©¿æ’å°æ¸¸æˆä½œä¸ºå¥–åŠ±ã€‚</div>
                        </div>
                    </div>

                    <div class="suggestion-item">
                        <div class="suggestion-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div>
                            <div class="font-medium text-green-800 mb-1">äº²å­äº’åŠ¨å¢å¼º</div>
                            <div class="text-sm text-green-700">å»ºè®®æ¯å‘¨å®‰æ’2-3æ¬¡äº²å­ä»»åŠ¡ï¼Œåœ¨è½»æ¾çš„æ°›å›´ä¸­æå‡å­©å­çš„æ²Ÿé€šè¡¨è¾¾èƒ½åŠ›ã€‚</div>
                        </div>
                    </div>
                </div>

                <!-- æˆé•¿é‡Œç¨‹ç¢‘ -->
                <div class="section-title">
                    <div class="section-icon"><i class="fas fa-trophy"></i></div>
                    <span>æˆé•¿é‡Œç¨‹ç¢‘</span>
                </div>

                <div class="achievement-timeline">
                    <div class="timeline-item">
                        <div class="timeline-date">ä»Šå¤©</div>
                        <div class="timeline-icon" style="background: linear-gradient(135deg, #8B5CF6, #7C3AED);">ğŸ¨</div>
                        <div class="timeline-content">
                            <div class="timeline-title">åˆ›æ„è¡¨è¾¾çªç ´</div>
                            <div class="timeline-description">å®Œæˆã€Šç¥å¥‡ä¸–ç•Œã€‹åˆ›ä½œï¼Œæƒ³è±¡åŠ›è¯„åˆ†è¾¾åˆ°ä¼˜ç§€çº§åˆ«</div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-date">æ˜¨å¤©</div>
                        <div class="timeline-icon" style="background: linear-gradient(135deg, #10B981, #059669);">ğŸ†</div>
                        <div class="timeline-content">
                            <div class="timeline-title">è¿ç»­å­¦ä¹ æˆå°±</div>
                            <div class="timeline-description">è¿ç»­7å¤©å®Œæˆå­¦ä¹ æ‰“å¡ï¼Œè·å¾—"åšæŒä¹‹æ˜Ÿ"å‹‹ç« </div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-date">3å¤©å‰</div>
                        <div class="timeline-icon" style="background: linear-gradient(135deg, #F59E0B, #D97706);">ğŸ’¬</div>
                        <div class="timeline-content">
                            <div class="timeline-title">æ²Ÿé€šèƒ½åŠ›æå‡</div>
                            <div class="timeline-description">ä¸AIåŠ©æ‰‹å¯¹è¯æ¬¡æ•°çªç ´100æ¬¡ï¼Œäº¤æµè´¨é‡æ˜¾è‘—æé«˜</div>
                        </div>
                    </div>
                    
                    <div class="timeline-item">
                        <div class="timeline-date">1å‘¨å‰</div>
                        <div class="timeline-icon" style="background: linear-gradient(135deg, #EC4899, #BE185D);">ğŸ“š</div>
                        <div class="timeline-content">
                            <div class="timeline-title">é˜…è¯»ç†è§£è¿›æ­¥</div>
                            <div class="timeline-description">é˜…è¯»ç†è§£æ­£ç¡®ç‡ä»70%æå‡åˆ°85%</div>
                        </div>
                    </div>
                </div>

                <!-- æ“ä½œæŒ‰é’® -->
                <div class="action-buttons">
                    <button class="action-btn primary-btn" onclick="generateDetailedReport()">
                        <i class="fas fa-file-alt text-lg"></i>
                        <span>ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š</span>
                    </button>
                    
                    <button class="action-btn secondary-btn" onclick="shareReport()">
                        <i class="fas fa-share text-lg"></i>
                        <span>åˆ†äº«æŠ¥å‘Š</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- æµ®åŠ¨å¯¼å‡ºæŒ‰é’® -->
    <div class="floating-export" onclick="exportReport()" title="å¯¼å‡ºæŠ¥å‘Š">
        <i class="fas fa-download"></i>
    </div>

    <script>
        // é¡µé¢åˆå§‹åŒ– - é›†æˆæ·±åº¦åˆ†æ
        MengyaUtils.Lifecycle.onInit(async () => {
            await initializeEnhancedReport();
            animateCharts();
            
            // å»¶è¿Ÿ2ç§’åå¼€å§‹æ·±åº¦åˆ†æï¼Œå±•ç¤ºåŠ è½½æ•ˆæœ
            setTimeout(() => {
                runDeepAnalysis();
            }, 2000);
        });

        // å¢å¼ºçš„æŠ¥å‘Šåˆå§‹åŒ–
        async function initializeEnhancedReport() {
            updateReportDate();
            await loadAnalyticsData();
            setupRealTimeUpdates();
        }

        // è¿è¡Œæ·±åº¦åˆ†æ
        async function runDeepAnalysis() {
            try {
                // è·å–æœ€æ–°çš„å­¦ä¹ ä¼šè¯æ•°æ®
                const latestSession = await getLatestSessionData();
                
                if (!latestSession) {
                    showFallbackAnalysis();
                    return;
                }

                // è¿è¡Œæ·±åº¦å­¦ä¹ åˆ†æ
                const analysis = await MengyaUtils.Analytics.analyzeComprehensively(latestSession);
                
                // æ›´æ–°UIæ˜¾ç¤º
                updateInsightContainer(analysis);
                updateBehaviorAnalysis(analysis);
                updatePredictiveAnalysis(analysis);
                
                MengyaUtils.Notification.success('æ·±åº¦å­¦ä¹ åˆ†æå®Œæˆï¼');
                
            } catch (error) {
                console.error('æ·±åº¦åˆ†æå¤±è´¥:', error);
                showAnalysisError();
            }
        }

        // è·å–æœ€æ–°å­¦ä¹ ä¼šè¯æ•°æ®
        async function getLatestSessionData() {
            const taskCompletion = await MengyaUtils.Data.getData('child.lastTaskCompletion');
            
            if (!taskCompletion) {
                // ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®ç”¨äºæ¼”ç¤º
                return {
                    sessionId: 'demo_' + Date.now(),
                    taskId: 'creative-world',
                    answer: 'åœ¨æˆ‘æƒ³è±¡ä¸­çš„ç¥å¥‡ä¸–ç•Œé‡Œï¼Œå¤©ç©ºæ˜¯å½©è™¹è‰²çš„ï¼Œäº‘æœµåƒæ£‰èŠ±ç³–ä¸€æ ·ç”œç¾ã€‚é‚£é‡Œæœ‰ä¼šè¯´è¯çš„å°åŠ¨ç‰©ï¼Œå®ƒä»¬éƒ½å¾ˆå‹å¥½ã€‚æ£®æ—é‡Œçš„æ ‘æœ¨ä¼šå”±æ­Œï¼ŒèŠ±æœµä¼šè·³èˆã€‚æˆ‘åœ¨é‚£é‡Œé‡åˆ°äº†ä¸€åªèªæ˜çš„å°ç‹ç‹¸ï¼Œå®ƒæ•™ä¼šäº†æˆ‘å¦‚ä½•ç”¨å¿ƒçµæ„Ÿå—å¤§è‡ªç„¶çš„ç¾å¦™ã€‚æˆ‘ä»¬ä¸€èµ·æ¢é™©ï¼Œå‘ç°äº†å¾ˆå¤šæœ‰è¶£çš„ç§˜å¯†ã€‚',
                    wordCount: 108,
                    timeUsed: 18 * 60, // 18åˆ†é’Ÿ
                    timestamp: Date.now(),
                    score: 88
                };
            }
            
            return {
                sessionId: taskCompletion.taskId + '_' + taskCompletion.timestamp,
                taskId: taskCompletion.taskId,
                answer: taskCompletion.answer,
                wordCount: taskCompletion.wordCount,
                timeUsed: taskCompletion.timeUsed,
                timestamp: taskCompletion.timestamp,
                score: taskCompletion.score
            };
        }

        // æ›´æ–°AIæ´å¯Ÿå®¹å™¨
        function updateInsightContainer(analysis) {
            const container = document.getElementById('insightContainer');
            const insights = generateInsightCards(analysis);
            
            container.innerHTML = insights;
            
            // æ·»åŠ å‡ºç°åŠ¨ç”»
            setTimeout(() => {
                container.querySelectorAll('.insight-card').forEach((card, index) => {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(20px)';
                    
                    setTimeout(() => {
                        card.style.transition = 'all 0.6s ease';
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, index * 200);
                });
            }, 100);
        }

        // ç”Ÿæˆæ´å¯Ÿå¡ç‰‡HTML
        function generateInsightCards(analysis) {
            const abilities = analysis.abilityAnalysis;
            const recommendations = analysis.personalizedRecommendations;
            
            // æ‰¾å‡ºæœ€å¼ºå’Œæœ€å¼±çš„èƒ½åŠ›
            const abilityScores = Object.entries(abilities).map(([name, data]) => ({
                name,
                score: data.score,
                level: data.level
            }));
            
            const strongest = abilityScores.reduce((a, b) => a.score > b.score ? a : b);
            const weakest = abilityScores.reduce((a, b) => a.score < b.score ? a : b);
            
            return `
                <div class="insight-card">
                    <h4 class="font-semibold text-sky-800 mb-3">ğŸ¯ AIæ·±åº¦æ´å¯Ÿ</h4>
                    <p class="text-sm text-sky-700 leading-relaxed mb-4">
                        é€šè¿‡AIæ·±åº¦åˆ†æï¼Œå‘ç°å­©å­åœ¨<strong>${getAbilityDisplayName(strongest.name)}</strong>æ–¹é¢è¡¨ç°çªå‡ºï¼ˆ${strongest.score}åˆ†ï¼‰ï¼Œ
                        å±•ç°å‡º${strongest.level}çš„æ°´å¹³ã€‚åŒæ—¶ï¼Œ<strong>${getAbilityDisplayName(weakest.name)}</strong>è¿˜æœ‰è¾ƒå¤§æå‡ç©ºé—´ã€‚
                    </p>
                    <div class="grid grid-cols-2 gap-3 text-xs">
                        <div class="bg-white bg-opacity-70 rounded-lg p-2">
                            <div class="font-medium text-sky-800">ä¼˜åŠ¿èƒ½åŠ›</div>
                            <div class="text-sky-600">${getAbilityDisplayName(strongest.name)}</div>
                        </div>
                        <div class="bg-white bg-opacity-70 rounded-lg p-2">
                            <div class="font-medium text-sky-800">æˆé•¿ç©ºé—´</div>
                            <div class="text-sky-600">${getAbilityDisplayName(weakest.name)}</div>
                        </div>
                    </div>
                </div>
                
                <div class="insight-card">
                    <h4 class="font-semibold text-green-800 mb-3">ğŸ“ˆ å­¦ä¹ æ¨¡å¼åˆ†æ</h4>
                    <p class="text-sm text-green-700 leading-relaxed mb-4">
                        AIæ£€æµ‹åˆ°å­©å­çš„å­¦ä¹ æ¨¡å¼ä¸º<strong>åˆ›æ„é©±åŠ¨å‹</strong>ï¼Œåœ¨å¯Œæœ‰æƒ³è±¡åŠ›çš„ä»»åŠ¡ä¸­è¡¨ç°æ›´ä½³ã€‚
                        å»ºè®®é‡‡ç”¨æ•…äº‹åŒ–ã€æ¸¸æˆåŒ–çš„å­¦ä¹ æ–¹å¼æ¥ç»´æŒå­¦ä¹ å…´è¶£ã€‚
                    </p>
                    <div class="flex items-center space-x-4 text-xs">
                        <span class="bg-green-100 text-green-800 px-2 py-1 rounded">æƒ³è±¡åŠ›ä¸°å¯Œ</span>
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded">è¡¨è¾¾ç”ŸåŠ¨</span>
                        <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded">äº’åŠ¨ç§¯æ</span>
                    </div>
                </div>
                
                <div class="insight-card">
                    <h4 class="font-semibold text-amber-800 mb-3">ğŸš€ ä¸ªæ€§åŒ–å»ºè®®</h4>
                    <div class="space-y-2 text-sm">
                        ${generateRecommendationItems(recommendations)}
                    </div>
                </div>
            `;
        }

        // ç”Ÿæˆå»ºè®®é¡¹ç›®
        function generateRecommendationItems(recommendations) {
            const allRecs = [
                ...recommendations.immediate,
                ...recommendations.shortTerm
            ].slice(0, 3);
            
            if (allRecs.length === 0) {
                return '<div class="text-amber-700">ç»§ç»­ä¿æŒå½“å‰çš„å­¦ä¹ èŠ‚å¥ï¼Œè¡¨ç°å¾ˆæ£’ï¼</div>';
            }
            
            return allRecs.map(rec => `
                <div class="flex items-start space-x-2">
                    <div class="w-2 h-2 bg-amber-500 rounded-full mt-1.5 flex-shrink-0"></div>
                    <span class="text-amber-700">${rec.description || rec.title}</span>
                </div>
            `).join('');
        }

        // æ›´æ–°è¡Œä¸ºåˆ†ææ˜¾ç¤º
        function updateBehaviorAnalysis(analysis) {
            const patterns = analysis.behaviorPatterns;
            const emotional = analysis.emotionalState;
            
            // æ›´æ–°æ—¶é—´åå¥½
            updateTimePreferences(patterns.timePreferences);
            
            // æ›´æ–°æ³¨æ„åŠ›æ¨¡å¼
            updateAttentionPatterns(analysis);
            
            // æ›´æ–°å­¦ä¹ ç­–ç•¥
            updateLearningStrategies(analysis);
            
            // æ›´æ–°æƒ…æ„ŸçŠ¶æ€
            updateEmotionalState(emotional);
        }

        function updateTimePreferences(timeData) {
            const statusEl = document.getElementById('timePreferenceStatus');
            const detailsEl = document.getElementById('timePreferenceDetails');
            
            if (timeData.pattern === 'insufficient_data') {
                statusEl.textContent = 'æ•°æ®ç§¯ç´¯ä¸­';
                detailsEl.innerHTML = `
                    <div class="text-sm text-gray-600">
                        éœ€è¦æ›´å¤šå­¦ä¹ æ•°æ®æ¥åˆ†ææ—¶é—´åå¥½æ¨¡å¼
                    </div>
                `;
            } else {
                const timeNames = {
                    morning: 'ä¸Šåˆæ—¶æ®µ',
                    afternoon: 'ä¸‹åˆæ—¶æ®µ',
                    evening: 'æ™šä¸Šæ—¶æ®µ'
                };
                
                statusEl.textContent = `åå¥½${timeNames[timeData.pattern]}å­¦ä¹ `;
                detailsEl.innerHTML = `
                    <div class="text-sm text-gray-700 mb-2">
                        åœ¨${timeNames[timeData.pattern]}å­¦ä¹ æ•ˆæœæœ€ä½³
                    </div>
                    <div class="text-xs text-gray-500">
                        ${timeData.recommendation || 'å»ºè®®åœ¨æ­¤æ—¶æ®µå®‰æ’é‡è¦å­¦ä¹ ä»»åŠ¡'}
                    </div>
                `;
            }
        }

        function updateAttentionPatterns(analysis) {
            const statusEl = document.getElementById('attentionStatus');
            const detailsEl = document.getElementById('attentionDetails');
            
            const focusScore = analysis.abilityAnalysis.focus.score;
            let pattern = '';
            let recommendation = '';
            
            if (focusScore >= 80) {
                pattern = 'ä¸“æ³¨åŠ›ä¼˜ç§€';
                recommendation = 'èƒ½å¤ŸæŒç»­ä¸“æ³¨ï¼Œé€‚åˆé•¿æ—¶é—´å­¦ä¹ ä»»åŠ¡';
            } else if (focusScore >= 60) {
                pattern = 'ä¸“æ³¨åŠ›è‰¯å¥½';
                recommendation = 'å»ºè®®é€‚å½“ä¼‘æ¯ï¼Œé‡‡ç”¨ç•ªèŒ„å·¥ä½œæ³•';
            } else {
                pattern = 'ä¸“æ³¨åŠ›å¾…æå‡';
                recommendation = 'å»ºè®®åˆ†è§£ä»»åŠ¡ï¼Œå¢åŠ äº’åŠ¨å…ƒç´ ';
            }
            
            statusEl.textContent = pattern;
            detailsEl.innerHTML = `
                <div class="text-sm text-gray-700 mb-2">
                    ä¸“æ³¨åŠ›è¯„åˆ†: ${focusScore}/100
                </div>
                <div class="text-xs text-gray-500">
                    ${recommendation}
                </div>
            `;
        }

        function updateLearningStrategies(analysis) {
            const statusEl = document.getElementById('strategyStatus');
            const detailsEl = document.getElementById('strategyDetails');
            
            // åŸºäºèƒ½åŠ›åˆ†ææ¨æ–­å­¦ä¹ ç­–ç•¥åå¥½
            const creativity = analysis.abilityAnalysis.creativity.score;
            const logic = analysis.abilityAnalysis.logic.score;
            
            let strategy = '';
            let description = '';
            
            if (creativity > logic) {
                strategy = 'åˆ›æ„å¯¼å‘å‹';
                description = 'åå¥½é€šè¿‡æƒ³è±¡å’Œåˆ›é€ æ¥å­¦ä¹ ';
            } else if (logic > creativity) {
                strategy = 'é€»è¾‘å¯¼å‘å‹';
                description = 'åå¥½é€šè¿‡æ¨ç†å’Œåˆ†ææ¥å­¦ä¹ ';
            } else {
                strategy = 'å¹³è¡¡å‘å±•å‹';
                description = 'åˆ›æ„å’Œé€»è¾‘èƒ½åŠ›å‡è¡¡å‘å±•';
            }
            
            statusEl.textContent = strategy;
            detailsEl.innerHTML = `
                <div class="text-sm text-gray-700 mb-2">
                    ${description}
                </div>
                <div class="text-xs text-gray-500">
                    å»ºè®®é‡‡ç”¨å¤šæ ·åŒ–çš„å­¦ä¹ æ–¹å¼
                </div>
            `;
        }

        function updateEmotionalState(emotional) {
            const statusEl = document.getElementById('emotionalStatus');
            const detailsEl = document.getElementById('emotionalDetails');
            
            // æ¨¡æ‹Ÿæƒ…æ„Ÿåˆ†æç»“æœ
            const emotionalStates = [
                { state: 'ç§¯æä¹è§‚', color: 'text-green-600', description: 'å­¦ä¹ æ€åº¦ç§¯æï¼Œæƒ…ç»ªç¨³å®š' },
                { state: 'ä¸“æ³¨æŠ•å…¥', color: 'text-blue-600', description: 'å¯¹å­¦ä¹ å†…å®¹è¡¨ç°å‡ºæµ“åšå…´è¶£' },
                { state: 'è½»æ¾æ„‰å¿«', color: 'text-purple-600', description: 'å­¦ä¹ è¿‡ç¨‹ä¸­ä¿æŒæ„‰æ‚¦å¿ƒæƒ…' }
            ];
            
            const currentState = emotionalStates[Math.floor(Math.random() * emotionalStates.length)];
            
            statusEl.textContent = currentState.state;
            statusEl.className = `text-sm ${currentState.color}`;
            
            detailsEl.innerHTML = `
                <div class="text-sm text-gray-700 mb-2">
                    ${currentState.description}
                </div>
                <div class="text-xs text-gray-500">
                    æƒ…æ„ŸçŠ¶æ€å¯¹å­¦ä¹ æ•ˆæœæœ‰ç§¯æå½±å“
                </div>
            `;
        }

        // è·å–èƒ½åŠ›æ˜¾ç¤ºåç§°
        function getAbilityDisplayName(abilityName) {
            const names = {
                expression: 'è¯­è¨€è¡¨è¾¾',
                logic: 'é€»è¾‘æ€ç»´',
                creativity: 'åˆ›æ„æ€ç»´',
                focus: 'ä¸“æ³¨æŒç»­'
            };
            return names[abilityName] || abilityName;
        }

        // æ˜¾ç¤ºåˆ†æé”™è¯¯
        function showAnalysisError() {
            const container = document.getElementById('insightContainer');
            container.innerHTML = `
                <div class="insight-card">
                    <h4 class="font-semibold text-red-800 mb-3">âš ï¸ åˆ†ææš‚æ—¶ä¸å¯ç”¨</h4>
                    <p class="text-sm text-red-700">
                        AIåˆ†æå¼•æ“æš‚æ—¶é‡åˆ°é—®é¢˜ï¼Œè¯·ç¨åé‡è¯•ã€‚æ‚¨ä»å¯ä»¥æŸ¥çœ‹åŸºç¡€å­¦ä¹ æ•°æ®ã€‚
                    </p>
                </div>
            `;
        }

        // æ˜¾ç¤ºåå¤‡åˆ†æ
        function showFallbackAnalysis() {
            const container = document.getElementById('insightContainer');
            container.innerHTML = `
                <div class="insight-card">
                    <h4 class="font-semibold text-blue-800 mb-3">ğŸ“Š åŸºç¡€åˆ†ææŠ¥å‘Š</h4>
                    <p class="text-sm text-blue-700 mb-4">
                        å­©å­æœ€è¿‘çš„å­¦ä¹ è¡¨ç°è‰¯å¥½ï¼Œå»ºè®®ç»§ç»­ä¿æŒå½“å‰çš„å­¦ä¹ èŠ‚å¥ã€‚
                        å®Œæˆæ›´å¤šå­¦ä¹ ä»»åŠ¡åï¼ŒAIå°†èƒ½æä¾›æ›´è¯¦ç»†çš„ä¸ªæ€§åŒ–åˆ†æã€‚
                    </p>
                    <div class="text-xs text-blue-600">
                        ğŸ’¡ æç¤ºï¼šæ›´å¤šå­¦ä¹ æ•°æ®å°†è§£é”æ·±åº¦AIåˆ†æåŠŸèƒ½
                    </div>
                </div>
            `;
        }

        // åŠ è½½åˆ†ææ•°æ®
        async function loadAnalyticsData() {
            try {
                const analyticsData = await MengyaUtils.Data.getData('analytics.latestAnalysis');
                if (analyticsData) {
                    // å·²åŠ è½½å†å²åˆ†ææ•°æ®
                }
            } catch (error) {
                // é¦–æ¬¡ä½¿ç”¨ï¼Œæš‚æ— å†å²åˆ†ææ•°æ®
            }
        }

        // è®¾ç½®å®æ—¶æ›´æ–°
        function setupRealTimeUpdates() {
            // æ¯5åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡æ˜¯å¦æœ‰æ–°çš„å­¦ä¹ æ•°æ®
            setInterval(async () => {
                const lastUpdate = await MengyaUtils.Data.getData('child.progress.lastUpdated');
                const lastCheck = localStorage.getItem('lastAnalysisCheck');
                
                if (lastUpdate && (!lastCheck || lastUpdate > parseInt(lastCheck))) {
                    // æ£€æµ‹åˆ°æ–°çš„å­¦ä¹ æ•°æ®ï¼Œå‡†å¤‡æ›´æ–°åˆ†æ
                    localStorage.setItem('lastAnalysisCheck', Date.now().toString());
                    // å¯ä»¥é€‰æ‹©è‡ªåŠ¨é‡æ–°åˆ†ææˆ–æç¤ºç”¨æˆ·
                }
            }, 5 * 60 * 1000);
        }

        // æ›´æ–°é¢„æµ‹åˆ†æï¼ˆå¯é€‰ï¼‰
        function updatePredictiveAnalysis(analysis) {
            const predictions = analysis.predictions;
            if (predictions) {
                // é¢„æµ‹åˆ†æç»“æœ
                // è¿™é‡Œå¯ä»¥æ·»åŠ é¢„æµ‹åˆ†æçš„UIæ›´æ–°
            }
        }

        // æ›´æ–°æŠ¥å‘Šæ—¥æœŸ
        function updateReportDate() {
            const now = new Date();
            const options = { month: 'long', day: 'numeric' };
            const dateStr = now.toLocaleDateString('zh-CN', options);
            const reportDateEl = document.getElementById('reportDate');
            if (reportDateEl) {
                reportDateEl.textContent = `æˆªè‡³${dateStr}`;
            }
        }

        // æ•°å­—åŠ¨ç”»
        function animateCounters(userData) {
            const counters = document.querySelectorAll('.stat-number');
            counters.forEach(counter => {
                const target = parseInt(counter.textContent) || 0;
                let current = 0;
                const increment = target / 30;
                
                const timer = setInterval(() => {
                    current += increment;
                    if (current >= target) {
                        current = target;
                        clearInterval(timer);
                    }
                    counter.textContent = Math.floor(current);
                }, 50);
            });
        }

        // å›¾è¡¨åŠ¨ç”»
        function animateCharts() {
            const progressFills = document.querySelectorAll('.progress-fill');
            const chartFills = document.querySelectorAll('.chart-fill');
            
            // å»¶è¿Ÿæ‰§è¡ŒåŠ¨ç”»
            setTimeout(() => {
                progressFills.forEach(fill => {
                    const width = fill.style.width;
                    fill.style.width = '0%';
                    setTimeout(() => {
                        fill.style.width = width;
                    }, 100);
                });
                
                chartFills.forEach((fill, index) => {
                    const width = fill.style.width;
                    fill.style.width = '0%';
                    setTimeout(() => {
                        fill.style.width = width;
                    }, 200 + index * 100);
                });
            }, 500);
        }

        // ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š
        function generateDetailedReport() {
            MengyaUtils.Notification.info('æ­£åœ¨ç”Ÿæˆè¯¦ç»†æŠ¥å‘Š...');
            
            setTimeout(() => {
                const report = `
ğŸ“Š å°æ˜çš„è¯¦ç»†æˆé•¿æŠ¥å‘Š

ğŸ“ˆ ç»¼åˆèƒ½åŠ›è¯„ä¼°ï¼š92åˆ† (ä¼˜ç§€)
â€¢ åˆ›æ„è¡¨è¾¾ï¼š88åˆ† - æƒ³è±¡åŠ›ä¸°å¯Œï¼Œè¡¨è¾¾ç”ŸåŠ¨
â€¢ é€»è¾‘æ€ç»´ï¼š72åˆ† - åŸºç¡€æ‰å®ï¼Œéœ€åŠ å¼ºè®­ç»ƒ  
â€¢ æ²Ÿé€šäº¤æµï¼š85åˆ† - äº’åŠ¨ç§¯æï¼Œç†è§£åŠ›å¼º
â€¢ ä¸“æ³¨æŒç»­ï¼š65åˆ† - å…´è¶£å¯¼å‘ï¼Œéœ€è¦å¼•å¯¼

ğŸ¯ å­¦ä¹ ç‰¹ç‚¹åˆ†æï¼š
â€¢ å¯¹åˆ›æ„ç±»ä»»åŠ¡å…´è¶£æµ“åšï¼Œå®Œæˆè´¨é‡é«˜
â€¢ å–„äºç”¨æ•…äº‹å’Œæ¯”å–»ç†è§£æŠ½è±¡æ¦‚å¿µ
â€¢ å–œæ¬¢äº’åŠ¨å¼å­¦ä¹ ï¼Œä¸å¤ªé€‚åº”å•è°ƒç»ƒä¹ 
â€¢ åœ¨é¼“åŠ±å’Œè®¤å¯ä¸‹è¡¨ç°æ›´ä½³

ğŸ’¡ å®¶é•¿æŒ‡å¯¼å»ºè®®ï¼š
â€¢ å¤šç»™äºˆåˆ›æ„è¡¨è¾¾çš„æœºä¼šå’Œå¹³å°
â€¢ ç”¨æ¸¸æˆåŒ–æ–¹å¼è¿›è¡Œé€»è¾‘æ€ç»´è®­ç»ƒ
â€¢ å»ºç«‹å­¦ä¹ å¥–åŠ±æœºåˆ¶ï¼Œæå‡ä¸“æ³¨åŠ›
â€¢ å®šæœŸè¿›è¡Œäº²å­äº’åŠ¨å­¦ä¹ æ´»åŠ¨

ğŸ“… ä¸‹å‘¨å­¦ä¹ è®¡åˆ’ï¼š
â€¢ å‘¨ä¸€ï¼šåˆ›æ„å†™ä½œè¿›é˜¶è®­ç»ƒ
â€¢ å‘¨äºŒï¼šæ•°å­¦é€»è¾‘æ¸¸æˆ
â€¢ å‘¨ä¸‰ï¼šäº²å­æ•…äº‹åˆ›ä½œ
â€¢ å‘¨å››ï¼šä¸“æ³¨åŠ›æå‡ç»ƒä¹ 
â€¢ å‘¨äº”ï¼šç»¼åˆèƒ½åŠ›æµ‹è¯„

æœ¬æŠ¥å‘ŠåŸºäºAIç®—æ³•åˆ†æç”Ÿæˆï¼Œå»ºè®®ç»“åˆå®é™…æƒ…å†µè°ƒæ•´ã€‚
                `;
                
                MengyaUtils.Notification.success('è¯¦ç»†æŠ¥å‘Šå·²ç”Ÿæˆï¼');
                // ç”ŸæˆæŠ¥å‘Šå®Œæˆï¼Œå®é™…åº”ç”¨ä¸­å¯ä»¥å¼¹çª—æ˜¾ç¤ºæˆ–ä¸‹è½½
            }, 2000);
        }

        // åˆ†äº«æŠ¥å‘Š
        function shareReport() {
            if (navigator.share) {
                navigator.share({
                    title: 'å°æ˜çš„AIæˆé•¿åˆ†ææŠ¥å‘Š',
                    text: 'æŸ¥çœ‹å­©å­çš„æœ€æ–°å­¦ä¹ åˆ†æå’Œæˆé•¿å»ºè®®',
                    url: window.location.href
                });
            } else {
                // å¤‡ç”¨åˆ†äº«æ–¹æ¡ˆ
                const shareText = 'æŸ¥çœ‹å°æ˜çš„AIæˆé•¿åˆ†ææŠ¥å‘Šï¼šç»¼åˆèƒ½åŠ›92åˆ†ï¼Œåˆ›æ„è¡¨è¾¾è¡¨ç°çªå‡ºï¼';
                navigator.clipboard.writeText(shareText).then(() => {
                    MengyaUtils.Notification.success('åˆ†äº«å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
                });
            }
        }

        // å¯¼å‡ºæŠ¥å‘Š
        function exportReport() {
            MengyaUtils.Notification.info('æ­£åœ¨å‡†å¤‡æŠ¥å‘Šå¯¼å‡º...');
            
            setTimeout(() => {
                // æ¨¡æ‹Ÿå¯¼å‡ºåŠŸèƒ½
                const reportData = {
                    date: new Date().toISOString(),
                    studentName: 'å°æ˜',
                    overallScore: 92,
                    abilities: {
                        creativity: 88,
                        logic: 72,
                        communication: 85,
                        focus: 65
                    },
                    weeklyTrend: [75, 82, 90, 88, 95],
                    suggestions: [
                        'æ·±åŒ–åˆ›æ„è¡¨è¾¾è®­ç»ƒ',
                        'é€»è¾‘æ€ç»´æ¸¸æˆåŒ–è®­ç»ƒ',
                        'ä¸“æ³¨åŠ›åˆ†é˜¶æ®µè®­ç»ƒ',
                        'äº²å­äº’åŠ¨å¢å¼º'
                    ]
                };
                
                // å®é™…åº”ç”¨ä¸­è¿™é‡Œä¼šç”ŸæˆPDFæˆ–Excelæ–‡ä»¶
                // æŠ¥å‘Šæ•°æ®å‡†å¤‡å®Œæˆ
                MengyaUtils.Notification.success('æŠ¥å‘Šå·²å¯¼å‡ºåˆ°ä¸‹è½½æ–‡ä»¶å¤¹');
            }, 1500);
        }

        // è¿”å›ä¸Šä¸€é¡µ
        function navigateBack() {
            MengyaUtils.Navigation.smartBack();
        }
    </script>
</body>
</html>
