<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•…äº‹å¢™ - èŒèŠ½AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .story-app {
            height: 100vh;
            display: flex;
            flex-direction: column;
            background: #f8fafc;
        }
        
        /* é¡¶éƒ¨å¯¼èˆª - å›ºå®šé«˜åº¦ */
        .story-header {
            height: 70px;
            background: linear-gradient(135deg, #F59E0B 0%, #D97706 100%);
            color: white;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
            position: relative;
            z-index: 100;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .back-btn {
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .header-info h3 {
            font-size: 18px;
            font-weight: 600;
            margin: 0;
        }
        
        .header-info p {
            font-size: 12px;
            opacity: 0.9;
            margin: 2px 0 0 0;
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .create-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }
        
        .create-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }
        
        /* ç­›é€‰æ ‡ç­¾æ  - å›ºå®šé«˜åº¦ */
        .filter-tabs {
            height: 50px;
            background: white;
            padding: 8px 20px;
            display: flex;
            gap: 8px;
            overflow-x: auto;
            flex-shrink: 0;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .filter-tabs::-webkit-scrollbar {
            display: none;
        }
        
        .filter-tab {
            padding: 6px 16px;
            background: #f8fafc;
            border: 1px solid #e5e7eb;
            border-radius: 20px;
            font-size: 12px;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
            flex-shrink: 0;
        }
        
        .filter-tab.active {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            color: white;
            border-color: #F59E0B;
        }
        
        .filter-tab:hover:not(.active) {
            background: #f3f4f6;
            border-color: #d1d5db;
        }
        
        /* æ•…äº‹åˆ—è¡¨åŒºåŸŸ - å¯æ»šåŠ¨ */
        .story-list {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            min-height: 0;
        }
        
        .story-list::-webkit-scrollbar {
            width: 4px;
        }
        
        .story-list::-webkit-scrollbar-track {
            background: transparent;
        }
        
        .story-list::-webkit-scrollbar-thumb {
            background: rgba(245, 158, 11, 0.3);
            border-radius: 2px;
        }
        
        /* æ•…äº‹å¡ç‰‡æ ·å¼ */
        .story-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            animation: slideIn 0.4s ease;
            position: relative;
        }
        
        .story-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 30px rgba(245, 158, 11, 0.15);
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .story-header-card {
            padding: 16px 20px 12px 20px;
            border-bottom: 1px solid #f1f5f9;
        }
        
        .story-author {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }
        
        .author-avatar {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #8B5CF6, #EC4899);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: white;
        }
        
        .author-info {
            flex: 1;
        }
        
        .author-name {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 2px;
        }
        
        .story-time {
            font-size: 11px;
            color: #9ca3af;
        }
        
        .story-type {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 500;
        }
        
        .story-title {
            font-size: 16px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
            line-height: 1.3;
        }
        
        .story-content {
            padding: 0 20px 16px 20px;
        }
        
        .story-excerpt {
            font-size: 14px;
            color: #6b7280;
            line-height: 1.6;
            margin-bottom: 16px;
            max-height: 80px;
            overflow: hidden;
            position: relative;
        }
        
        .story-excerpt::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 20px;
            background: linear-gradient(transparent, white);
        }
        
        .story-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-bottom: 16px;
        }
        
        .story-tag {
            background: #f8fafc;
            color: #6b7280;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 10px;
            border: 1px solid #e5e7eb;
        }
        
        .story-actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
            background: #f8fafc;
            border-top: 1px solid #f1f5f9;
        }
        
        .action-group {
            display: flex;
            gap: 16px;
        }
        
        .action-btn {
            display: flex;
            align-items: center;
            gap: 4px;
            background: none;
            border: none;
            color: #6b7280;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 4px 8px;
            border-radius: 8px;
        }
        
        .action-btn:hover {
            color: #F59E0B;
            background: rgba(245, 158, 11, 0.1);
        }
        
        .action-btn.liked {
            color: #EF4444;
        }
        
        .read-more-btn {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .read-more-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
        }
        
        /* åˆ›ä½œæ¨¡æ€æ¡† */
        .create-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 20px;
        }
        
        .create-modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .create-modal-content {
            background: white;
            border-radius: 20px;
            width: 100%;
            max-width: 480px;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            transform: translateY(-30px) scale(0.95);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
        }
        
        .create-modal.show .create-modal-content {
            transform: translateY(0) scale(1);
        }
        
        .create-header {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }
        
        .create-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        .create-close {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .create-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .create-form {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .form-label {
            font-size: 14px;
            font-weight: 600;
            color: #374151;
        }
        
        .form-input {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 14px;
            color: #374151;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #F59E0B;
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
        }
        
        .form-textarea {
            min-height: 120px;
            resize: vertical;
            font-family: inherit;
        }
        
        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 12px center;
            background-repeat: no-repeat;
            background-size: 16px;
            padding-right: 40px;
        }
        
        .tag-input-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 8px 12px;
            min-height: 44px;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .tag-input-container:focus-within {
            border-color: #F59E0B;
            box-shadow: 0 0 0 3px rgba(245, 158, 11, 0.1);
        }
        
        .tag-item {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .tag-remove {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 14px;
            padding: 0;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.2s ease;
        }
        
        .tag-remove:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .tag-input {
            flex: 1;
            border: none;
            outline: none;
            background: transparent;
            font-size: 14px;
            min-width: 100px;
        }
        
        .create-footer {
            padding: 20px 24px;
            background: #f8fafc;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 12px;
            flex-shrink: 0;
        }
        
        .footer-btn {
            flex: 1;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .footer-btn.secondary {
            background: white;
            color: #6b7280;
            border: 1px solid #e5e7eb;
        }
        
        .footer-btn.secondary:hover {
            background: #f9fafb;
            border-color: #d1d5db;
        }
        
        .footer-btn.primary {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            color: white;
        }
        
        .footer-btn.primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }
        
        /* ç©ºçŠ¶æ€ */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #9ca3af;
        }
        
        .empty-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        .empty-title {
            font-size: 18px;
            font-weight: 600;
            color: #6b7280;
            margin-bottom: 8px;
        }
        
        .empty-desc {
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 24px;
        }
        
        .empty-action {
            background: linear-gradient(135deg, #F59E0B, #D97706);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .empty-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }
        
        /* æ•…äº‹è¯¦æƒ…æ¨¡æ€æ¡† */
        .story-detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: flex-start;
            justify-content: center;
            z-index: 2001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            padding: 20px;
            padding-top: 40px;
            overflow-y: auto;
        }
        
        .story-detail-modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .story-detail-content {
            background: white;
            border-radius: 20px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            transform: translateY(-30px) scale(0.95);
            transition: transform 0.3s ease;
            margin-bottom: 40px;
        }
        
        .story-detail-modal.show .story-detail-content {
            transform: translateY(0) scale(1);
        }
        
        .detail-header {
            background: linear-gradient(135deg, #8B5CF6, #EC4899);
            color: white;
            padding: 24px 24px 20px 24px;
            border-radius: 20px 20px 0 0;
        }
        
        .detail-close {
            float: right;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 16px;
        }
        
        .detail-close:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .detail-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 8px;
            clear: both;
        }
        
        .detail-meta {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 12px;
            opacity: 0.9;
        }
        
        .detail-body {
            padding: 24px;
        }
        
        .detail-content {
            font-size: 15px;
            line-height: 1.8;
            color: #374151;
            margin-bottom: 24px;
        }
        
        .detail-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 24px;
        }
        
        .detail-tag {
            background: #f8fafc;
            color: #6b7280;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 12px;
            border: 1px solid #e5e7eb;
        }
        
        .detail-actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px;
            background: #f8fafc;
            border-top: 1px solid #e5e7eb;
        }
        
        .detail-action-group {
            display: flex;
            gap: 20px;
        }
        
        .detail-action-btn {
            display: flex;
            align-items: center;
            gap: 6px;
            background: none;
            border: none;
            color: #6b7280;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 8px 12px;
            border-radius: 12px;
        }
        
        .detail-action-btn:hover {
            color: #F59E0B;
            background: rgba(245, 158, 11, 0.1);
        }
        
        .detail-action-btn.liked {
            color: #EF4444;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 480px) {
            .story-header {
                padding: 12px 16px;
                height: 60px;
            }
            
            .header-info h3 {
                font-size: 16px;
            }
            
            .filter-tabs {
                padding: 6px 16px;
                height: 44px;
            }
            
            .story-list {
                padding: 16px;
                gap: 16px;
            }
            
            .story-card {
                border-radius: 16px;
            }
            
            .story-header-card {
                padding: 14px 16px 10px 16px;
            }
            
            .story-content {
                padding: 0 16px 14px 16px;
            }
            
            .story-actions {
                padding: 10px 16px;
            }
            
            .create-modal {
                padding: 16px;
            }
            
            .story-detail-modal {
                padding: 16px;
                padding-top: 30px;
            }
        }
    </style>
</head>
<body>
    <div class="story-app">
        <!-- é¡¶éƒ¨å¯¼èˆª -->
        <div class="story-header">
            <div class="header-left">
                <button class="back-btn" onclick="navigateToPage('home')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div class="header-info">
                    <h3>æ•…äº‹å¢™</h3>
                    <p>åˆ†äº«ä½ çš„ç²¾å½©æ•…äº‹</p>
                </div>
            </div>
            <div class="header-right">
                <button class="create-btn" onclick="openCreateModal()">
                    <i class="fas fa-plus mr-1"></i>
                    åˆ›ä½œæ•…äº‹
                </button>
            </div>
        </div>

        <!-- ç­›é€‰æ ‡ç­¾ -->
        <div class="filter-tabs">
            <button class="filter-tab active" onclick="filterStories('all')">å…¨éƒ¨</button>
            <button class="filter-tab" onclick="filterStories('adventure')">å†’é™©</button>
            <button class="filter-tab" onclick="filterStories('fantasy')">å¥‡å¹»</button>
            <button class="filter-tab" onclick="filterStories('friendship')">å‹è°Š</button>
            <button class="filter-tab" onclick="filterStories('animal')">åŠ¨ç‰©</button>
            <button class="filter-tab" onclick="filterStories('science')">ç§‘å­¦</button>
            <button class="filter-tab" onclick="filterStories('daily')">æ—¥å¸¸</button>
        </div>

        <!-- æ•…äº‹åˆ—è¡¨ -->
        <div class="story-list" id="storyList">
            <!-- æ•…äº‹ä¼šé€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
        </div>
    </div>

    <!-- åˆ›ä½œæ•…äº‹æ¨¡æ€æ¡† -->
    <div class="create-modal" id="createModal">
        <div class="create-modal-content">
            <div class="create-header">
                <div class="create-title">åˆ›ä½œæ–°æ•…äº‹</div>
                <button class="create-close" onclick="closeCreateModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <form class="create-form" id="createForm">
                <div class="form-group">
                    <label class="form-label">æ•…äº‹æ ‡é¢˜</label>
                    <input type="text" class="form-input" id="storyTitle" placeholder="ç»™ä½ çš„æ•…äº‹èµ·ä¸ªæœ‰è¶£çš„åå­—..." required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">æ•…äº‹ç±»å‹</label>
                    <select class="form-input form-select" id="storyType" required>
                        <option value="">é€‰æ‹©æ•…äº‹ç±»å‹</option>
                        <option value="adventure">å†’é™©æ•…äº‹</option>
                        <option value="fantasy">å¥‡å¹»æ•…äº‹</option>
                        <option value="friendship">å‹è°Šæ•…äº‹</option>
                        <option value="animal">åŠ¨ç‰©æ•…äº‹</option>
                        <option value="science">ç§‘å­¦æ•…äº‹</option>
                        <option value="daily">æ—¥å¸¸æ•…äº‹</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">æ•…äº‹å†…å®¹</label>
                    <textarea class="form-input form-textarea" id="storyContent" placeholder="åœ¨è¿™é‡Œå†™ä¸‹ä½ çš„ç²¾å½©æ•…äº‹...

æç¤ºï¼š
â€¢ ç”¨ç”ŸåŠ¨çš„è¯­è¨€æè¿°æ•…äº‹æƒ…èŠ‚
â€¢ å¯ä»¥åŠ å…¥å¯¹è¯è®©æ•…äº‹æ›´æœ‰è¶£
â€¢ æè¿°äººç‰©çš„æ„Ÿå—å’Œå¿ƒæƒ…
â€¢ è®©æ•…äº‹æœ‰ä¸€ä¸ªå¥½çš„ç»“å±€" required></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">æ•…äº‹æ ‡ç­¾</label>
                    <div class="tag-input-container" id="tagContainer">
                        <input type="text" class="tag-input" id="tagInput" placeholder="è¾“å…¥æ ‡ç­¾åæŒ‰å›è½¦æ·»åŠ ...">
                    </div>
                </div>
            </form>
            
            <div class="create-footer">
                <button type="button" class="footer-btn secondary" onclick="closeCreateModal()">
                    å–æ¶ˆ
                </button>
                <button type="button" class="footer-btn primary" onclick="submitStory()">
                    å‘å¸ƒæ•…äº‹
                </button>
            </div>
        </div>
    </div>

    <!-- æ•…äº‹è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div class="story-detail-modal" id="storyDetailModal">
        <div class="story-detail-content">
            <div class="detail-header">
                <button class="detail-close" onclick="closeStoryDetail()">
                    <i class="fas fa-times"></i>
                </button>
                <div class="detail-title" id="detailTitle">æ•…äº‹æ ‡é¢˜</div>
                <div class="detail-meta" id="detailMeta">
                    <span>ä½œè€…ï¼šå°æ˜</span>
                    <span>â€¢</span>
                    <span>2å¤©å‰</span>
                    <span>â€¢</span>
                    <span>å†’é™©æ•…äº‹</span>
                </div>
            </div>
            
            <div class="detail-body">
                <div class="detail-content" id="detailContent">
                    æ•…äº‹å†…å®¹å°†åœ¨è¿™é‡Œæ˜¾ç¤º...
                </div>
                
                <div class="detail-tags" id="detailTags">
                    <!-- æ ‡ç­¾å°†åŠ¨æ€åŠ è½½ -->
                </div>
            </div>
            
            <div class="detail-actions">
                <div class="detail-action-group">
                    <button class="detail-action-btn" id="detailLikeBtn" onclick="toggleLike(this)">
                        <i class="fas fa-heart"></i>
                        <span id="detailLikeCount">12</span>
                    </button>
                    <button class="detail-action-btn" onclick="shareStory()">
                        <i class="fas fa-share"></i>
                        åˆ†äº«
                    </button>
                    <button class="detail-action-btn" onclick="reportStory()">
                        <i class="fas fa-flag"></i>
                        ä¸¾æŠ¥
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ•…äº‹æ•°æ®
        let stories = [
            {
                id: 1,
                title: "å‹‡æ•¢çš„å°å…”å­å†’é™©è®°",
                author: "å°æ˜",
                avatar: "ğŸ°",
                time: "2å°æ—¶å‰",
                type: "adventure",
                typeName: "å†’é™©æ•…äº‹",
                content: `ä»å‰æœ‰ä¸€åªå‹‡æ•¢çš„å°å…”å­å«åšè·³è·³ï¼Œå®ƒä½åœ¨æ£®æ—æ·±å¤„çš„ä¸€ä¸ªå°æ´é‡Œã€‚æœ‰ä¸€å¤©ï¼Œè·³è·³å¬è¯´æ£®æ—çš„å¦ä¸€è¾¹æœ‰ä¸€åº§ç¥å¥‡çš„å½©è™¹æ¡¥ï¼Œæ®è¯´èµ°è¿‡å½©è™¹æ¡¥çš„åŠ¨ç‰©éƒ½èƒ½å®ç°ä¸€ä¸ªæ„¿æœ›ã€‚

è·³è·³çš„æ„¿æœ›æ˜¯è®©æ£®æ—é‡Œæ‰€æœ‰çš„å°åŠ¨ç‰©éƒ½èƒ½å¿«ä¹åœ°ç”Ÿæ´»åœ¨ä¸€èµ·ã€‚äºæ˜¯ï¼Œå®ƒå†³å®šè¸ä¸Šå¯»æ‰¾å½©è™¹æ¡¥çš„å†’é™©ä¹‹æ—…ã€‚

è·¯ä¸Šï¼Œè·³è·³é‡åˆ°äº†è®¸å¤šå›°éš¾ï¼šé™©å³»çš„å±±å³°ã€æ¹æ€¥çš„æ²³æµã€èŒ‚å¯†çš„è†æ£˜ä¸›ã€‚ä½†æ˜¯æ¯å½“é‡åˆ°å›°éš¾æ—¶ï¼Œè·³è·³éƒ½ä¼šæƒ³èµ·è‡ªå·±çš„æ„¿æœ›ï¼Œç„¶åå‹‡æ•¢åœ°ç»§ç»­å‰è¿›ã€‚

åœ¨è·¯ä¸Šï¼Œè·³è·³è¿˜ç»“è¯†äº†å¾ˆå¤šæœ‹å‹ï¼šèªæ˜çš„å°ç‹ç‹¸ã€å¼ºå£®çš„å°ç†Šã€æœºçµçš„å°æ¾é¼ ã€‚å¤§å®¶ä¸€èµ·äº’ç›¸å¸®åŠ©ï¼Œå…±åŒå…‹æœå›°éš¾ã€‚

ç»è¿‡ä¸ƒå¤©ä¸ƒå¤œçš„è·‹æ¶‰ï¼Œä»–ä»¬ç»ˆäºæ‰¾åˆ°äº†ä¼ è¯´ä¸­çš„å½©è™¹æ¡¥ã€‚æ¡¥çš„é‚£è¾¹æœ‰ä¸€ä½æ…ˆç¥¥çš„ä»™å¥³ï¼Œå¥¹å¯¹è·³è·³è¯´ï¼š"å­©å­ï¼Œä½ å·²ç»å®ç°äº†è‡ªå·±çš„æ„¿æœ›ã€‚ä½ çœ‹ï¼Œä½ çš„å‹‡æ•¢å’Œå–„è‰¯å·²ç»è®©è¿™ä¹ˆå¤šæœ‹å‹èšé›†åœ¨ä½ èº«è¾¹ï¼Œå¤§å®¶å¿«ä¹åœ°ç”Ÿæ´»åœ¨ä¸€èµ·ï¼Œè¿™ä¸å°±æ˜¯ä½ æƒ³è¦çš„å—ï¼Ÿ"

è·³è·³è¿™æ‰æ˜ç™½ï¼ŒçœŸæ­£çš„é­”æ³•ä¸åœ¨å½©è™¹æ¡¥ï¼Œè€Œåœ¨äºå‹‡æ•¢ã€å–„è‰¯å’Œå‹è°Šã€‚ä»æ­¤ï¼Œæ£®æ—é‡Œçš„å°åŠ¨ç‰©ä»¬éƒ½è¿‡ä¸Šäº†å¹¸ç¦å¿«ä¹çš„ç”Ÿæ´»ã€‚`,
                excerpt: "ä»å‰æœ‰ä¸€åªå‹‡æ•¢çš„å°å…”å­å«åšè·³è·³ï¼Œå®ƒä½åœ¨æ£®æ—æ·±å¤„çš„ä¸€ä¸ªå°æ´é‡Œã€‚æœ‰ä¸€å¤©ï¼Œè·³è·³å¬è¯´æ£®æ—çš„å¦ä¸€è¾¹æœ‰ä¸€åº§ç¥å¥‡çš„å½©è™¹æ¡¥...",
                tags: ["å‹‡æ•¢", "å‹è°Š", "æˆé•¿", "å†’é™©"],
                likes: 24,
                comments: 8,
                shares: 3,
                liked: false
            },
            {
                id: 2,
                title: "é­”æ³•æ£®æ—çš„ç§˜å¯†",
                author: "å°çº¢",
                avatar: "ğŸŒ¸",
                time: "1å¤©å‰",
                type: "fantasy",
                typeName: "å¥‡å¹»æ•…äº‹",
                content: `åœ¨ä¸€ä¸ªé¥è¿œçš„åœ°æ–¹ï¼Œæœ‰ä¸€ç‰‡ç¥ç§˜çš„é­”æ³•æ£®æ—ã€‚è¿™ç‰‡æ£®æ—é‡Œä½ç€å„ç§ä¼šè¯´è¯çš„æ¤ç‰©å’ŒåŠ¨ç‰©ï¼Œè¿˜æœ‰å–„è‰¯çš„å°ç²¾çµä»¬ã€‚

å°å¥³å­©è‰¾ç±³åœ¨ä¸€ä¸ªé˜³å…‰æ˜åªšçš„ä¸‹åˆï¼Œæ— æ„ä¸­å‘ç°äº†è¿™ç‰‡æ£®æ—çš„å…¥å£ã€‚å½“å¥¹è¸è¿›æ£®æ—çš„é‚£ä¸€åˆ»ï¼Œçœ¼å‰çš„æ™¯è±¡è®©å¥¹æƒŠå‘†äº†ï¼šæ ‘æœ¨ä¼šå”±æ­Œï¼ŒèŠ±æœµä¼šè·³èˆï¼Œè´è¶çš„ç¿…è†€é—ªé—ªå‘å…‰åƒæ˜Ÿæ˜Ÿä¸€æ ·ã€‚

"æ¬¢è¿æ¥åˆ°é­”æ³•æ£®æ—ï¼"ä¸€åªå°ç²¾çµé£åˆ°è‰¾ç±³é¢å‰è¯´é“ã€‚"æˆ‘æ˜¯éœ²å¨œï¼Œè¿™é‡Œçš„å‘å¯¼ç²¾çµã€‚"

éœ²å¨œå‘Šè¯‰è‰¾ç±³ï¼Œè¿™ç‰‡æ£®æ—æ­£é¢ä¸´ç€ä¸€ä¸ªå¤§å±æœºï¼šé‚ªæ¶çš„é»‘æš—æ³•å¸ˆæƒ³è¦å¤ºèµ°æ£®æ—çš„é­”æ³•ä¹‹æºâ€”â€”ç”Ÿå‘½ä¹‹æ ‘çš„åŠ›é‡ã€‚å¦‚æœç”Ÿå‘½ä¹‹æ ‘å¤±å»åŠ›é‡ï¼Œæ•´ä¸ªæ£®æ—éƒ½ä¼šæ¯èã€‚

è‰¾ç±³å†³å®šå¸®åŠ©æ£®æ—çš„æœ‹å‹ä»¬ä¿æŠ¤ç”Ÿå‘½ä¹‹æ ‘ã€‚åœ¨éœ²å¨œçš„æŒ‡å¼•ä¸‹ï¼Œå¥¹å¼€å§‹äº†ä¸€æ®µå¥‡å¦™çš„å†’é™©ä¹‹æ—…ã€‚å¥¹å­¦ä¼šäº†å’ŒåŠ¨æ¤ç‰©äº¤æµï¼ŒæŒæ¡äº†ä¸€äº›ç®€å•çš„é­”æ³•ï¼Œè¿˜ç»“è¯†äº†è®¸å¤šå‹‡æ•¢çš„ä¼™ä¼´ã€‚

æœ€ç»ˆï¼Œåœ¨å¤§å®¶çš„å…±åŒåŠªåŠ›ä¸‹ï¼Œä»–ä»¬æˆåŠŸå‡»è´¥äº†é»‘æš—æ³•å¸ˆï¼Œä¿æŠ¤äº†ç”Ÿå‘½ä¹‹æ ‘ã€‚ä½œä¸ºæ„Ÿè°¢ï¼Œæ£®æ—çš„é­”æ³•è®©è‰¾ç±³æ‹¥æœ‰äº†æ°¸è¿œä¸è‡ªç„¶äº¤æµçš„èƒ½åŠ›ã€‚

ä»é‚£ä»¥åï¼Œè‰¾ç±³æˆä¸ºäº†æ£®æ—çš„å®ˆæŠ¤è€…ï¼Œæ¯å½“æœ‰äººéœ€è¦å¸®åŠ©æ—¶ï¼Œå¥¹å°±ä¼šå‡ºç°ã€‚`,
                excerpt: "åœ¨ä¸€ä¸ªé¥è¿œçš„åœ°æ–¹ï¼Œæœ‰ä¸€ç‰‡ç¥ç§˜çš„é­”æ³•æ£®æ—ã€‚è¿™ç‰‡æ£®æ—é‡Œä½ç€å„ç§ä¼šè¯´è¯çš„æ¤ç‰©å’ŒåŠ¨ç‰©ï¼Œè¿˜æœ‰å–„è‰¯çš„å°ç²¾çµä»¬...",
                tags: ["é­”æ³•", "ç²¾çµ", "å‹‡æ°”", "è‡ªç„¶"],
                likes: 18,
                comments: 5,
                shares: 2,
                liked: true
            },
            {
                id: 3,
                title: "å°çŒ«å’ªçš„æ–°æœ‹å‹",
                author: "å°æ",
                avatar: "ğŸ±",
                time: "3å¤©å‰",
                type: "friendship",
                typeName: "å‹è°Šæ•…äº‹",
                content: `å°çŒ«å’ªå’ªå’ªæ˜¯ä¸€åªå¾ˆå®³ç¾çš„çŒ«å’ªï¼Œå®ƒä½åœ¨åŸå¸‚é‡Œçš„ä¸€ä¸ªå°å…¬å›­é™„è¿‘ã€‚è™½ç„¶å…¬å›­é‡Œæœ‰å¾ˆå¤šå°åŠ¨ç‰©ï¼Œä½†å’ªå’ªä¸€ç›´æ²¡æœ‰çœŸæ­£çš„æœ‹å‹ã€‚

æœ‰ä¸€å¤©ï¼Œå’ªå’ªåœ¨å…¬å›­é‡Œå‘ç°äº†ä¸€åªå—ä¼¤çš„å°é¸Ÿã€‚å°é¸Ÿçš„ç¿…è†€å—äº†ä¼¤ï¼Œä¸èƒ½é£äº†ã€‚å’ªå’ªè™½ç„¶å®³ç¾ï¼Œä½†æ˜¯å®ƒæœ‰ä¸€é¢—å–„è‰¯çš„å¿ƒï¼Œäºæ˜¯å†³å®šå¸®åŠ©è¿™åªå°é¸Ÿã€‚

å’ªå’ªå°å¿ƒç¿¼ç¿¼åœ°æŠŠå°é¸Ÿå¸¦å›äº†å®¶ï¼Œç»™å®ƒåŒ…æ‰ä¼¤å£ï¼Œå–‚å®ƒåƒä¸œè¥¿ï¼Œè¿˜ä¸ºå®ƒæ­å»ºäº†ä¸€ä¸ªèˆ’é€‚çš„å°çªã€‚åœ¨ç…§é¡¾å°é¸Ÿçš„è¿‡ç¨‹ä¸­ï¼Œå’ªå’ªå’Œå°é¸Ÿæ…¢æ…¢æˆäº†å¥½æœ‹å‹ã€‚

å°é¸Ÿå‘Šè¯‰å’ªå’ªï¼Œå®ƒå«å•¾å•¾ï¼Œæ¥è‡ªå¾ˆè¿œçš„åœ°æ–¹ã€‚å•¾å•¾å¾ˆæ„Ÿè°¢å’ªå’ªçš„å¸®åŠ©ï¼Œä¹Ÿå¾ˆå–œæ¬¢å’Œå’ªå’ªèŠå¤©ã€‚ä»–ä»¬ä¸€èµ·è®²æ•…äº‹ï¼Œä¸€èµ·ç©æ¸¸æˆï¼Œå’ªå’ªå‘ç°æœ‰æœ‹å‹é™ªä¼´çš„æ—¥å­æ˜¯å¤šä¹ˆå¿«ä¹ã€‚

å‡ ä¸ªæ˜ŸæœŸåï¼Œå•¾å•¾çš„ä¼¤å¥½äº†ï¼Œå¯ä»¥é£äº†ã€‚è™½ç„¶æœ‰äº›ä¸èˆï¼Œä½†å’ªå’ªçŸ¥é“å•¾å•¾åº”è¯¥å›åˆ°å±äºå®ƒçš„åœ°æ–¹ã€‚

åœ¨é€åˆ«çš„é‚£å¤©ï¼Œå•¾å•¾å¯¹å’ªå’ªè¯´ï¼š"è°¢è°¢ä½ ï¼Œå’ªå’ªã€‚è™½ç„¶æˆ‘è¦èµ°äº†ï¼Œä½†æˆ‘ä»¬æ°¸è¿œéƒ½æ˜¯å¥½æœ‹å‹ã€‚è€Œä¸”ï¼Œæˆ‘ä¼šå‘Šè¯‰å…¶ä»–çš„æœ‹å‹ï¼Œä½ æ˜¯ä¸€åªå–„è‰¯åˆå¯çˆ±çš„çŒ«å’ªã€‚"

æœç„¶ï¼Œä»é‚£ä»¥åï¼Œå…¬å›­é‡Œçš„å°åŠ¨ç‰©ä»¬éƒ½æ„¿æ„å’Œå’ªå’ªåšæœ‹å‹ã€‚å’ªå’ªä¸å†å­¤å•ï¼Œå®ƒæ˜ç™½äº†å‹è°Šçš„çœŸè°›ï¼šçœŸæ­£çš„æœ‹å‹ä¼šè®©ä½ å˜å¾—æ›´å‹‡æ•¢ï¼Œæ›´å¿«ä¹ã€‚`,
                excerpt: "å°çŒ«å’ªå’ªå’ªæ˜¯ä¸€åªå¾ˆå®³ç¾çš„çŒ«å’ªï¼Œå®ƒä½åœ¨åŸå¸‚é‡Œçš„ä¸€ä¸ªå°å…¬å›­é™„è¿‘ã€‚è™½ç„¶å…¬å›­é‡Œæœ‰å¾ˆå¤šå°åŠ¨ç‰©ï¼Œä½†å’ªå’ªä¸€ç›´æ²¡æœ‰çœŸæ­£çš„æœ‹å‹...",
                tags: ["å‹è°Š", "å–„è‰¯", "æˆé•¿", "åŠ¨ç‰©"],
                likes: 15,
                comments: 12,
                shares: 1,
                liked: false
            }
        ];

        let currentFilter = 'all';
        let storyTags = [];

        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            loadStories();
            setupTagInput();
        });

        // åŠ è½½æ•…äº‹åˆ—è¡¨
        function loadStories() {
            const storyList = document.getElementById('storyList');
            const filteredStories = currentFilter === 'all' 
                ? stories 
                : stories.filter(story => story.type === currentFilter);

            if (filteredStories.length === 0) {
                storyList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“š</div>
                        <div class="empty-title">æš‚æ— æ•…äº‹</div>
                        <div class="empty-desc">è¿™ä¸ªåˆ†ç±»è¿˜æ²¡æœ‰æ•…äº‹å‘¢<br>å¿«æ¥åˆ›ä½œç¬¬ä¸€ä¸ªæ•…äº‹å§ï¼</div>
                        <button class="empty-action" onclick="openCreateModal()">
                            å¼€å§‹åˆ›ä½œ
                        </button>
                    </div>
                `;
                return;
            }

            const storiesHTML = filteredStories.map(story => `
                <div class="story-card" data-type="${story.type}">
                    <div class="story-header-card">
                        <div class="story-author">
                            <div class="author-avatar">${story.avatar}</div>
                            <div class="author-info">
                                <div class="author-name">${story.author}</div>
                                <div class="story-time">${story.time}</div>
                            </div>
                            <div class="story-type">${story.typeName}</div>
                        </div>
                        <div class="story-title">${story.title}</div>
                    </div>
                    
                    <div class="story-content">
                        <div class="story-excerpt">${story.excerpt}</div>
                        <div class="story-tags">
                            ${story.tags.map(tag => `<span class="story-tag">#${tag}</span>`).join('')}
                        </div>
                    </div>
                    
                    <div class="story-actions">
                        <div class="action-group">
                            <button class="action-btn ${story.liked ? 'liked' : ''}" onclick="toggleLike(this, ${story.id})">
                                <i class="fas fa-heart"></i>
                                <span>${story.likes}</span>
                            </button>
                            <button class="action-btn" onclick="showStoryDetail(${story.id})">
                                <i class="fas fa-comment"></i>
                                <span>${story.comments}</span>
                            </button>
                            <button class="action-btn" onclick="shareStory(${story.id})">
                                <i class="fas fa-share"></i>
                                <span>${story.shares}</span>
                            </button>
                        </div>
                        <button class="read-more-btn" onclick="showStoryDetail(${story.id})">
                            é˜…è¯»å…¨æ–‡
                        </button>
                    </div>
                </div>
            `).join('');

            storyList.innerHTML = storiesHTML;

            // æ·»åŠ åŠ è½½åŠ¨ç”»å»¶è¿Ÿ
            setTimeout(() => {
                const cards = document.querySelectorAll('.story-card');
                cards.forEach((card, index) => {
                    card.style.animationDelay = `${index * 0.1}s`;
                });
            }, 100);
        }

        // ç­›é€‰æ•…äº‹
        function filterStories(type) {
            currentFilter = type;
            
            // æ›´æ–°æ ‡ç­¾çŠ¶æ€
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // é‡æ–°åŠ è½½æ•…äº‹
            loadStories();
            
            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            document.getElementById('storyList').scrollTop = 0;
            
            const typeNames = {
                'all': 'å…¨éƒ¨',
                'adventure': 'å†’é™©',
                'fantasy': 'å¥‡å¹»',
                'friendship': 'å‹è°Š',
                'animal': 'åŠ¨ç‰©',
                'science': 'ç§‘å­¦',
                'daily': 'æ—¥å¸¸'
            };
            
            if (type !== 'all') {
                showNotification(`å·²ç­›é€‰${typeNames[type]}æ•…äº‹`, 'info');
            }
        }

        // åˆ‡æ¢ç‚¹èµçŠ¶æ€
        function toggleLike(button, storyId) {
            const story = stories.find(s => s.id === storyId);
            const span = button.querySelector('span');
            const currentLikes = parseInt(span.textContent);
            
            if (button.classList.contains('liked')) {
                button.classList.remove('liked');
                story.liked = false;
                story.likes = currentLikes - 1;
                span.textContent = story.likes;
                showNotification('å·²å–æ¶ˆç‚¹èµ', 'info');
            } else {
                button.classList.add('liked');
                story.liked = true;
                story.likes = currentLikes + 1;
                span.textContent = story.likes;
                showNotification('ç‚¹èµæˆåŠŸï¼', 'success');
                
                // æ·»åŠ éœ‡åŠ¨åé¦ˆ
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
            }
        }

        // æ˜¾ç¤ºæ•…äº‹è¯¦æƒ…
        function showStoryDetail(storyId) {
            const story = stories.find(s => s.id === storyId);
            if (!story) return;

            document.getElementById('detailTitle').textContent = story.title;
            document.getElementById('detailMeta').innerHTML = `
                <span>ä½œè€…ï¼š${story.author}</span>
                <span>â€¢</span>
                <span>${story.time}</span>
                <span>â€¢</span>
                <span>${story.typeName}</span>
            `;
            document.getElementById('detailContent').innerHTML = story.content.replace(/\n/g, '<br><br>');
            
            // æ›´æ–°æ ‡ç­¾
            const tagsHTML = story.tags.map(tag => `<span class="detail-tag">#${tag}</span>`).join('');
            document.getElementById('detailTags').innerHTML = tagsHTML;
            
            // æ›´æ–°ç‚¹èµæŒ‰é’®
            const likeBtn = document.getElementById('detailLikeBtn');
            const likeCount = document.getElementById('detailLikeCount');
            likeBtn.className = `detail-action-btn ${story.liked ? 'liked' : ''}`;
            likeCount.textContent = story.likes;
            
            // è®¾ç½®ç‚¹èµæŒ‰é’®çš„æ•°æ®å±æ€§
            likeBtn.setAttribute('data-story-id', storyId);
            
            document.getElementById('storyDetailModal').classList.add('show');
            
            // å¢åŠ é˜…è¯»ç»Ÿè®¡
            showNotification('æ­£åœ¨åŠ è½½æ•…äº‹è¯¦æƒ…...', 'info');
        }

        // å…³é—­æ•…äº‹è¯¦æƒ…
        function closeStoryDetail() {
            document.getElementById('storyDetailModal').classList.remove('show');
        }

        // æ‰“å¼€åˆ›ä½œæ¨¡æ€æ¡†
        function openCreateModal() {
            document.getElementById('createModal').classList.add('show');
            document.getElementById('storyTitle').focus();
            resetCreateForm();
        }

        // å…³é—­åˆ›ä½œæ¨¡æ€æ¡†
        function closeCreateModal() {
            document.getElementById('createModal').classList.remove('show');
            resetCreateForm();
        }

        // é‡ç½®åˆ›ä½œè¡¨å•
        function resetCreateForm() {
            document.getElementById('createForm').reset();
            storyTags = [];
            updateTagDisplay();
        }

        // è®¾ç½®æ ‡ç­¾è¾“å…¥
        function setupTagInput() {
            const tagInput = document.getElementById('tagInput');
            
            tagInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ',') {
                    e.preventDefault();
                    addTag();
                }
            });
            
            tagInput.addEventListener('blur', function() {
                if (this.value.trim()) {
                    addTag();
                }
            });
        }

        // æ·»åŠ æ ‡ç­¾
        function addTag() {
            const tagInput = document.getElementById('tagInput');
            const tagText = tagInput.value.trim();
            
            if (tagText && !storyTags.includes(tagText) && storyTags.length < 6) {
                storyTags.push(tagText);
                updateTagDisplay();
                tagInput.value = '';
            } else if (storyTags.length >= 6) {
                showNotification('æœ€å¤šåªèƒ½æ·»åŠ 6ä¸ªæ ‡ç­¾', 'warning');
            }
        }

        // æ›´æ–°æ ‡ç­¾æ˜¾ç¤º
        function updateTagDisplay() {
            const container = document.getElementById('tagContainer');
            const tagInput = document.getElementById('tagInput');
            
            // ç§»é™¤ç°æœ‰çš„æ ‡ç­¾å…ƒç´ 
            const existingTags = container.querySelectorAll('.tag-item');
            existingTags.forEach(tag => tag.remove());
            
            // æ·»åŠ æ–°æ ‡ç­¾
            storyTags.forEach((tag, index) => {
                const tagElement = document.createElement('div');
                tagElement.className = 'tag-item';
                tagElement.innerHTML = `
                    <span>${tag}</span>
                    <button type="button" class="tag-remove" onclick="removeTag(${index})">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                container.insertBefore(tagElement, tagInput);
            });
        }

        // ç§»é™¤æ ‡ç­¾
        function removeTag(index) {
            storyTags.splice(index, 1);
            updateTagDisplay();
        }

        // æäº¤æ•…äº‹
        function submitStory() {
            const title = document.getElementById('storyTitle').value.trim();
            const type = document.getElementById('storyType').value;
            const content = document.getElementById('storyContent').value.trim();
            
            if (!title || !type || !content) {
                showNotification('è¯·å¡«å†™å®Œæ•´çš„æ•…äº‹ä¿¡æ¯', 'warning');
                return;
            }
            
            if (content.length < 50) {
                showNotification('æ•…äº‹å†…å®¹è‡³å°‘éœ€è¦50ä¸ªå­—ç¬¦', 'warning');
                return;
            }
            
            // åˆ›å»ºæ–°æ•…äº‹
            const newStory = {
                id: stories.length + 1,
                title: title,
                author: 'å°æ˜åŒå­¦',
                avatar: 'ğŸ˜Š',
                time: 'åˆšåˆš',
                type: type,
                typeName: getTypeName(type),
                content: content,
                excerpt: content.substring(0, 100) + (content.length > 100 ? '...' : ''),
                tags: [...storyTags],
                likes: 0,
                comments: 0,
                shares: 0,
                liked: false
            };
            
            // æ·»åŠ åˆ°æ•…äº‹åˆ—è¡¨å¼€å¤´
            stories.unshift(newStory);
            
            // å…³é—­æ¨¡æ€æ¡†
            closeCreateModal();
            
            // é‡æ–°åŠ è½½æ•…äº‹åˆ—è¡¨
            loadStories();
            
            showNotification('æ•…äº‹å‘å¸ƒæˆåŠŸï¼', 'success');
            
            // éœ‡åŠ¨åé¦ˆ
            if (navigator.vibrate) {
                navigator.vibrate([100, 50, 100]);
            }
        }

        // è·å–ç±»å‹åç§°
        function getTypeName(type) {
            const typeMap = {
                'adventure': 'å†’é™©æ•…äº‹',
                'fantasy': 'å¥‡å¹»æ•…äº‹',
                'friendship': 'å‹è°Šæ•…äº‹',
                'animal': 'åŠ¨ç‰©æ•…äº‹',
                'science': 'ç§‘å­¦æ•…äº‹',
                'daily': 'æ—¥å¸¸æ•…äº‹'
            };
            return typeMap[type] || 'æœªçŸ¥ç±»å‹';
        }

        // åˆ†äº«æ•…äº‹
        function shareStory(storyId) {
            const story = storyId ? stories.find(s => s.id === storyId) : null;
            const shareText = story 
                ? `æˆ‘åœ¨èŒèŠ½AIåˆ†äº«äº†ä¸€ä¸ªæ•…äº‹ã€Š${story.title}ã€‹ï¼Œå¿«æ¥çœ‹çœ‹å§ï¼`
                : 'æˆ‘åœ¨èŒèŠ½AIæ•…äº‹å¢™å‘ç°äº†å¾ˆå¤šç²¾å½©æ•…äº‹ï¼Œå¿«æ¥çœ‹çœ‹å§ï¼';
            
            if (navigator.share) {
                navigator.share({
                    title: 'èŒèŠ½AI - æ•…äº‹å¢™',
                    text: shareText,
                    url: window.location.href
                }).then(() => {
                    showNotification('åˆ†äº«æˆåŠŸï¼', 'success');
                    if (story) {
                        story.shares++;
                        loadStories();
                    }
                }).catch(() => {
                    showNotification('åˆ†äº«å–æ¶ˆ', 'info');
                });
            } else {
                // é™çº§å¤„ç†ï¼šå¤åˆ¶é“¾æ¥
                navigator.clipboard.writeText(shareText + ' ' + window.location.href)
                    .then(() => {
                        showNotification('åˆ†äº«é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿', 'success');
                        if (story) {
                            story.shares++;
                            loadStories();
                        }
                    })
                    .catch(() => showNotification('åˆ†äº«åŠŸèƒ½æš‚ä¸å¯ç”¨', 'error'));
            }
        }

        // ä¸¾æŠ¥æ•…äº‹
        function reportStory() {
            showNotification('å·²æäº¤ä¸¾æŠ¥ï¼Œæˆ‘ä»¬ä¼šå°½å¿«å¤„ç†', 'info');
            closeStoryDetail();
        }

        // å¯¼èˆªåˆ°é¡µé¢
        function navigateToPage(page) {
            const pageMap = {
                'home': 'home.html',
                'learning-path': 'learning-path.html',
                'ai-assistant': 'ai-assistant.html',
                'profile': 'profile.html'
            };
            
            if (pageMap[page]) {
                parent.postMessage({
                    type: 'openPage',
                    url: pageMap[page]
                }, '*');
            } else {
                parent.postMessage({
                    type: 'navigate',
                    page: page
                }, '*');
            }
        }

        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message, type = 'info') {
            parent.postMessage({
                type: 'showNotification',
                message: message,
                notificationType: type
            }, '*');
        }

        // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
        document.getElementById('createModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCreateModal();
            }
        });

        document.getElementById('storyDetailModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeStoryDetail();
            }
        });

        // å¤„ç†è¯¦æƒ…æ¨¡æ€æ¡†ä¸­çš„ç‚¹èµ
        document.getElementById('detailLikeBtn').addEventListener('click', function() {
            const storyId = parseInt(this.getAttribute('data-story-id'));
            toggleLike(this, storyId);
            
            // åŒæ­¥æ›´æ–°è¯¦æƒ…é¡µé¢çš„ç‚¹èµæ•°
            const story = stories.find(s => s.id === storyId);
            if (story) {
                document.getElementById('detailLikeCount').textContent = story.likes;
            }
        });

        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', function(e) {
            // ESCé”®å…³é—­æ¨¡æ€æ¡†
            if (e.key === 'Escape') {
                if (document.getElementById('createModal').classList.contains('show')) {
                    closeCreateModal();
                } else if (document.getElementById('storyDetailModal').classList.contains('show')) {
                    closeStoryDetail();
                }
            }
            
            // Ctrl/Cmd + N æ–°å»ºæ•…äº‹
            if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                e.preventDefault();
                openCreateModal();
            }
        });

        // æ‰‹åŠ¿æ”¯æŒ
        let startX, startY;
        
        document.addEventListener('touchstart', function(e) {
            startX = e.touches[0].clientX;
            startY = e.touches[0].clientY;
        });
        
        document.addEventListener('touchend', function(e) {
            const endX = e.changedTouches[0].clientX;
            const endY = e.changedTouches[0].clientY;
            
            const diffX = startX - endX;
            const diffY = startY - endY;
            
            // å³æ»‘è¿”å›
            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
                if (diffX < 0) {
                    navigateToPage('home');
                }
            }
        });

        // æ— é™æ»šåŠ¨åŠ è½½æ›´å¤šæ•…äº‹
        let isLoading = false;
        
        document.getElementById('storyList').addEventListener('scroll', function() {
            if (isLoading) return;
            
            const { scrollTop, scrollHeight, clientHeight } = this;
            
            if (scrollTop + clientHeight >= scrollHeight - 100) {
                loadMoreStories();
            }
        });

        // åŠ è½½æ›´å¤šæ•…äº‹
        function loadMoreStories() {
            if (isLoading || stories.length >= 20) return; // é™åˆ¶æœ€å¤§æ•…äº‹æ•°
            
            isLoading = true;
            showNotification('æ­£åœ¨åŠ è½½æ›´å¤šæ•…äº‹...', 'info');
            
            setTimeout(() => {
                // æ¨¡æ‹Ÿç”Ÿæˆæ›´å¤šæ•…äº‹
                const moreStories = generateRandomStories(3);
                stories.push(...moreStories);
                loadStories();
                isLoading = false;
                showNotification('åŠ è½½å®Œæˆï¼', 'success');
            }, 1500);
        }

        // ç”Ÿæˆéšæœºæ•…äº‹
        function generateRandomStories(count) {
            const templates = [
                {
                    title: "å°ç†Šçš„èœ‚èœœå†’é™©",
                    type: "adventure",
                    avatar: "ğŸ»",
                    tags: ["å†’é™©", "å‹è°Š", "é£Ÿç‰©"]
                },
                {
                    title: "ç¥å¥‡çš„æ—¶å…‰æœºå™¨",
                    type: "science",
                    avatar: "âš¡",
                    tags: ["ç§‘æŠ€", "æ—¶é—´", "æ¢ç´¢"]
                },
                {
                    title: "èŠ±å›­é‡Œçš„å°ç²¾çµ",
                    type: "fantasy",
                    avatar: "ğŸ§š",
                    tags: ["é­”æ³•", "èŠ±å›­", "å¸®åŠ©"]
                },
                {
                    title: "ä¸¤åªå°é¸Ÿçš„æ•…äº‹",
                    type: "friendship",
                    avatar: "ğŸ¦",
                    tags: ["å‹è°Š", "é£ç¿”", "å®¶åº­"]
                }
            ];
            
            const authors = ["å°ç‹", "å°å¼ ", "å°åˆ˜", "å°é™ˆ", "å°èµµ"];
            const times = ["5å°æ—¶å‰", "1å¤©å‰", "2å¤©å‰", "3å¤©å‰", "1å‘¨å‰"];
            
            return Array.from({ length: count }, (_, index) => {
                const template = templates[Math.floor(Math.random() * templates.length)];
                const author = authors[Math.floor(Math.random() * authors.length)];
                const time = times[Math.floor(Math.random() * times.length)];
                
                return {
                    id: stories.length + index + 1,
                    title: template.title,
                    author: author,
                    avatar: template.avatar,
                    time: time,
                    type: template.type,
                    typeName: getTypeName(template.type),
                    content: `è¿™æ˜¯ä¸€ä¸ªå…³äº${template.title}çš„ç²¾å½©æ•…äº‹ã€‚æ•…äº‹è®²è¿°äº†ä¸»äººå…¬ç»å†çš„å„ç§å†’é™©å’Œæˆé•¿ï¼Œå……æ»¡äº†æƒ³è±¡åŠ›å’Œæ•™è‚²æ„ä¹‰ã€‚é€šè¿‡ç”ŸåŠ¨çš„æƒ…èŠ‚å’Œæœ‰è¶£çš„å¯¹è¯ï¼Œè®©è¯»è€…èƒ½å¤Ÿæ·±æ·±åœ°è¢«å¸å¼•ï¼ŒåŒæ—¶å­¦åˆ°å®è´µçš„äººç”Ÿé“ç†ã€‚`,
                    excerpt: `è¿™æ˜¯ä¸€ä¸ªå…³äº${template.title}çš„ç²¾å½©æ•…äº‹ã€‚æ•…äº‹è®²è¿°äº†ä¸»äººå…¬ç»å†çš„å„ç§å†’é™©å’Œæˆé•¿...`,
                    tags: template.tags,
                    likes: Math.floor(Math.random() * 20) + 1,
                    comments: Math.floor(Math.random() * 10) + 1,
                    shares: Math.floor(Math.random() * 5),
                    liked: Math.random() > 0.7
                };
            });
        }

        // é¡µé¢å¯è§æ€§å¤„ç†
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                // é¡µé¢é‡æ–°æ¿€æ´»æ—¶å¯ä»¥åˆ·æ–°æ•°æ®
                // æ•…äº‹å¢™é¡µé¢é‡æ–°æ¿€æ´»
            }
        });

        // è¡¨å•éªŒè¯å¢å¼º
        function validateStoryForm() {
            const title = document.getElementById('storyTitle').value.trim();
            const content = document.getElementById('storyContent').value.trim();
            
            let isValid = true;
            let errors = [];
            
            if (title.length < 2) {
                errors.push('æ ‡é¢˜è‡³å°‘éœ€è¦2ä¸ªå­—ç¬¦');
                isValid = false;
            }
            
            if (title.length > 50) {
                errors.push('æ ‡é¢˜ä¸èƒ½è¶…è¿‡50ä¸ªå­—ç¬¦');
                isValid = false;
            }
            
            if (content.length < 50) {
                errors.push('æ•…äº‹å†…å®¹è‡³å°‘éœ€è¦50ä¸ªå­—ç¬¦');
                isValid = false;
            }
            
            if (content.length > 2000) {
                errors.push('æ•…äº‹å†…å®¹ä¸èƒ½è¶…è¿‡2000ä¸ªå­—ç¬¦');
                isValid = false;
            }
            
            if (!isValid) {
                showNotification(errors.join('\n'), 'warning');
            }
            
            return isValid;
        }

        // ä¿®æ”¹æäº¤æ•…äº‹å‡½æ•°ä»¥åŒ…å«éªŒè¯
        function submitStory() {
            if (!validateStoryForm()) {
                return;
            }
            
            const title = document.getElementById('storyTitle').value.trim();
            const type = document.getElementById('storyType').value;
            const content = document.getElementById('storyContent').value.trim();
            
            if (!type) {
                showNotification('è¯·é€‰æ‹©æ•…äº‹ç±»å‹', 'warning');
                return;
            }
            
            // æ˜¾ç¤ºæäº¤ä¸­çŠ¶æ€
            const submitBtn = document.querySelector('.footer-btn.primary');
            const originalText = submitBtn.textContent;
            submitBtn.textContent = 'å‘å¸ƒä¸­...';
            submitBtn.disabled = true;
            
            setTimeout(() => {
                // åˆ›å»ºæ–°æ•…äº‹
                const newStory = {
                    id: stories.length + 1,
                    title: title,
                    author: 'å°æ˜åŒå­¦',
                    avatar: 'ğŸ˜Š',
                    time: 'åˆšåˆš',
                    type: type,
                    typeName: getTypeName(type),
                    content: content,
                    excerpt: content.substring(0, 100) + (content.length > 100 ? '...' : ''),
                    tags: [...storyTags],
                    likes: 0,
                    comments: 0,
                    shares: 0,
                    liked: false
                };
                
                // æ·»åŠ åˆ°æ•…äº‹åˆ—è¡¨å¼€å¤´
                stories.unshift(newStory);
                
                // æ¢å¤æŒ‰é’®çŠ¶æ€
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                
                // å…³é—­æ¨¡æ€æ¡†
                closeCreateModal();
                
                // é‡æ–°åŠ è½½æ•…äº‹åˆ—è¡¨
                loadStories();
                
                showNotification('æ•…äº‹å‘å¸ƒæˆåŠŸï¼ğŸ‰', 'success');
                
                // éœ‡åŠ¨åé¦ˆ
                if (navigator.vibrate) {
                    navigator.vibrate([100, 50, 100]);
                }
            }, 1000);
        }

        // æ·»åŠ å­—ç¬¦è®¡æ•°åŠŸèƒ½
        document.getElementById('storyContent').addEventListener('input', function() {
            const maxLength = 2000;
            const currentLength = this.value.length;
            const remaining = maxLength - currentLength;
            
            // å¯ä»¥åœ¨è¿™é‡Œæ˜¾ç¤ºå­—ç¬¦è®¡æ•°ï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰
            if (remaining < 100 && remaining >= 0) {
                // æ¥è¿‘é™åˆ¶æ—¶çš„æç¤º
                // å­—ç¬¦ç»Ÿè®¡æ›´æ–°
            } else if (remaining < 0) {
                // è¶…å‡ºé™åˆ¶
                this.value = this.value.substring(0, maxLength);
                showNotification('å­—ç¬¦æ•°å·²è¾¾åˆ°ä¸Šé™', 'warning');
            }
        });

        // åˆå§‹åŒ–å®Œæˆæç¤º
        setTimeout(() => {
            // æ•…äº‹å¢™åŠŸèƒ½åŠ è½½å®Œæˆ
        }, 1000);
    </script>
</body>
</html>